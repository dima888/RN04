<!DOCTYPE HTML><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>IPTABLES Manpage</TITLE>
<link rel="stylesheet" href="file:/opt/kde3/share/doc/HTML//en/common/kde-default.css" type="text/css">
<meta name="ROFF Type" content="man">
</HEAD>

<BODY BGCOLOR="#FFFFFF">

<div style="background-image: url(file:/opt/kde3/share/doc/HTML//en/common/top-middle.png); width: 100%; height: 131pt;">
<div style="position: absolute; right: 0pt;">
<img src="file:/opt/kde3/share/doc/HTML//en/common/top-right-konqueror.png" style="margin: 0pt" alt="Top right">
</div>
<div style="position: absolute; left: 0pt;">
<img src="file:/opt/kde3/share/doc/HTML//en/common/top-left.png" style="margin: 0pt" alt="Top left">
</div>
<div style="position: absolute; top: 25pt; right: 100pt; text-align: right; font-size: xx-large; font-weight: bold; text-shadow: #fff 0pt 0pt 5pt; color: #444">
IPTABLES</div>
</div>
<div style="margin-left: 5em; margin-right: 5em;">
<h1>IPTABLES</h1>
Section:  (8)

























<H2>NAME</H2>
<div>

iptables - administration tool for IPv4 packet filtering and NAT
</div>

<H2>SYNOPSIS</H2>
<div>

<span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">]</span> {</span><span style="font-weight:bold">-A</span>|</span><span style="font-weight:bold">-D</span>} </span><span style="font-style:italic">chain rule-specification</span> [</span><span style="font-style:italic">options...</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -I</span> [</span><span style="font-style:italic">rulenum</span>] </span><span style="font-style:italic">rule-specification</span> [</span><span style="font-style:italic">options...</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -R</span> </span><span style="font-style:italic">rulenum rule-specification</span> [</span><span style="font-style:italic">options...</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -D</span> </span><span style="font-style:italic">chain rulenum</span> [</span><span style="font-style:italic">options...</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -S</span> [</span><span style="font-style:italic">chain</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">]</span> {</span><span style="font-weight:bold">-F</span>|</span><span style="font-weight:bold">-L</span>|</span><span style="font-weight:bold">-Z</span>} [</span><span style="font-style:italic">chain</span>] [</span><span style="font-style:italic">options...</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -N</span> </span><span style="font-style:italic">chain</span>
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -X</span> [</span><span style="font-style:italic">chain</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -P</span> </span><span style="font-style:italic">chain target</span> [</span><span style="font-style:italic">options...</span>]
<BR>

</span><span style="font-weight:bold">iptables</span> [</span><span style="font-weight:bold">-t</span> </span><span style="font-style:italic">table</span></span><span style="font-weight:bold">] -E</span> </span><span style="font-style:italic">old-chain-name new-chain-name</span>
</span></div>

<H2>DESCRIPTION</H2>
<div>

<span style="font-weight:bold">Iptables</span> is used to set up, maintain, and inspect the
tables of IPv4 packet
filter rules in the Linux kernel.  Several different tables
may be defined.  Each table contains a number of built-in
chains and may also contain user-defined chains.
<P>
Each chain is a list of rules which can match a set of packets.  Each
rule specifies what to do with a packet that matches.  This is called
a `target', which may be a jump to a user-defined chain in the same
table.
<P>
</span></div>

<H2>TARGETS</H2>
<div>

A firewall rule specifies criteria for a packet and a target.  If the
packet does not match, the next rule in the chain is the examined; if
it does match, then the next rule is specified by the value of the
target, which can be the name of a user-defined chain or one of the
special values <span style="font-weight:bold">ACCEPT</span>, </span><span style="font-weight:bold">DROP</span>, </span><span style="font-weight:bold">QUEUE</span> or </span><span style="font-weight:bold">RETURN</span>.
<br><br>

</span><span style="font-weight:bold">ACCEPT</span> means to let the packet through.
</span><span style="font-weight:bold">DROP</span> means to drop the packet on the floor.
</span><span style="font-weight:bold">QUEUE</span> means to pass the packet to userspace.
(How the packet can be received
by a userspace process differs by the particular queue handler.  2.4.x
and 2.6.x kernels up to 2.6.13 include the </span><span style="font-weight:bold">ip_queue</span>
queue handler.  Kernels 2.6.14 and later additionally include the
</span><span style="font-weight:bold">nfnetlink_queue</span> queue handler.  Packets with a target of QUEUE will be
sent to queue number '0' in this case. Please also see the </span><span style="font-weight:bold">NFQUEUE</span>
target as described later in this man page.)
</span><span style="font-weight:bold">RETURN</span> means stop traversing this chain and resume at the next
rule in the
previous (calling) chain.  If the end of a built-in chain is reached
or a rule in a built-in chain with target </span><span style="font-weight:bold">RETURN</span>
is matched, the target specified by the chain policy determines the
fate of the packet.
</span></div>

<H2>TABLES</H2>
<div>

There are currently three independent tables (which tables are present
at any time depends on the kernel configuration options and which
modules are present).
<br><br><DL>
<DT><span style="font-weight:bold">-t</span>, </span><span style="font-weight:bold">--table</span> </span><span style="font-style:italic">table</span><DD>
This option specifies the packet matching table which the command
should operate on.  If the kernel is configured with automatic module
loading, an attempt will be made to load the appropriate module for
that table if it is not already there.
<P>
The tables are as follows:
<DL><DT><DD>
<br><br><DL>
<DT></span><span style="font-weight:bold">filter</span>:<DD>
This is the default table (if no -t option is passed).  It contains
the built-in chains </span><span style="font-weight:bold">INPUT</span> (for packets destined to local sockets),
</span><span style="font-weight:bold">FORWARD</span> (for packets being routed through the box), and
</span><span style="font-weight:bold">OUTPUT</span> (for locally-generated packets).
<DT></span><span style="font-weight:bold">nat</span>:<DD>
This table is consulted when a packet that creates a new
connection is encountered.  It consists of three built-ins: </span><span style="font-weight:bold">PREROUTING</span>
(for altering packets as soon as they come in), </span><span style="font-weight:bold">OUTPUT</span>
(for altering locally-generated packets before routing), and </span><span style="font-weight:bold">POSTROUTING</span>
(for altering packets as they are about to go out).
<DT></span><span style="font-weight:bold">mangle</span>:<DD>
This table is used for specialized packet alteration.  Until kernel
2.4.17 it had two built-in chains: </span><span style="font-weight:bold">PREROUTING</span>
(for altering incoming packets before routing) and </span><span style="font-weight:bold">OUTPUT</span>
(for altering locally-generated packets before routing).
Since kernel 2.4.18, three other built-in chains are also supported:
</span><span style="font-weight:bold">INPUT</span> (for packets coming into the box itself), </span><span style="font-weight:bold">FORWARD</span>
(for altering packets being routed through the box), and </span><span style="font-weight:bold">POSTROUTING</span>
(for altering packets as they are about to go out).
<DT></span><span style="font-weight:bold">raw</span>:<DD>
This table is used mainly for configuring exemptions from connection
tracking in combination with the NOTRACK target.  It registers at the netfilter
hooks with higher priority and is thus called before ip_conntrack, or any other
IP tables.  It provides the following built-in chains: </span><span style="font-weight:bold">PREROUTING</span>
(for packets arriving via any network interface) </span><span style="font-weight:bold">OUTPUT</span>
(for packets generated by local processes)
</DL></DL>

</DL>
</span></div>

<H2>OPTIONS</H2>
<div>

The options that are recognized by
<span style="font-weight:bold">iptables</span> can be divided into several different groups.
</span></div>

<H3>COMMANDS</H3>
<div>

These options specify the desired action to perform. Only one of them
can be specified on the command line unless otherwise stated
below. For long versions of the command and option names, you
need to use only enough letters to ensure that
<span style="font-weight:bold">iptables</span> can differentiate it from all other options.
<br><br><DL>
<DT></span><span style="font-weight:bold">-A</span>, </span><span style="font-weight:bold">--append</span> </span><span style="font-style:italic">chain rule-specification</span><DD>
Append one or more rules to the end of the selected chain.
When the source and/or destination names resolve to more than one
address, a rule will be added for each possible address combination.
<DT></span><span style="font-weight:bold">-D</span>, </span><span style="font-weight:bold">--delete</span> </span><span style="font-style:italic">chain rule-specification</span><DD>

<DT></span><span style="font-weight:bold">-D</span>, </span><span style="font-weight:bold">--delete</span> </span><span style="font-style:italic">chain rulenum</span><DD>
Delete one or more rules from the selected chain.  There are two
versions of this command: the rule can be specified as a number in the
chain (starting at 1 for the first rule) or a rule to match.
<DT></span><span style="font-weight:bold">-I</span>, </span><span style="font-weight:bold">--insert</span> </span><span style="font-style:italic">chain</span> [</span><span style="font-style:italic">rulenum</span>] </span><span style="font-style:italic">rule-specification</span><DD>
Insert one or more rules in the selected chain as the given rule
number.  So, if the rule number is 1, the rule or rules are inserted
at the head of the chain.  This is also the default if no rule number
is specified.
<DT></span><span style="font-weight:bold">-R</span>, </span><span style="font-weight:bold">--replace</span> </span><span style="font-style:italic">chain rulenum rule-specification</span><DD>
Replace a rule in the selected chain.  If the source and/or
destination names resolve to multiple addresses, the command will
fail.  Rules are numbered starting at 1.
<DT></span><span style="font-weight:bold">-L</span>, </span><span style="font-weight:bold">--list</span> [</span><span style="font-style:italic">chain</span>]<DD>
List all rules in the selected chain.  If no chain is selected, all
chains are listed. Like every other iptables command, it applies to the
specified table (filter is the default), so NAT rules get listed by
</span><PRE>
 iptables -t nat -n -L
</PRE>

Please note that it is often used with the <span style="font-weight:bold">-n</span>
option, in order to avoid long reverse DNS lookups.
It is legal to specify the </span><span style="font-weight:bold">-Z</span>
(zero) option as well, in which case the chain(s) will be atomically
listed and zeroed.  The exact output is affected by the other
arguments given. The exact rules are suppressed until you use
</span><PRE>
 iptables -L -v
</PRE>

<DT><span style="font-weight:bold">-S</span>, </span><span style="font-weight:bold">--list-rules</span> [</span><span style="font-style:italic">chain</span>]<DD>
Print all rules in the selected chain.  If no chain is selected, all
chains are printed like iptables-save. Like every other iptables command,
it applies to the specified table (filter is the default).
<DT></span><span style="font-weight:bold">-F</span>, </span><span style="font-weight:bold">--flush</span> [</span><span style="font-style:italic">chain</span>]<DD>
Flush the selected chain (all the chains in the table if none is given).
This is equivalent to deleting all the rules one by one.
<DT></span><span style="font-weight:bold">-Z</span>, </span><span style="font-weight:bold">--zero</span> [</span><span style="font-style:italic">chain</span>]<DD>
Zero the packet and byte counters in all chains.  It is legal to
specify the
</span><span style="font-weight:bold">-L</span>, </span><span style="font-weight:bold">--list</span>
(list) option as well, to see the counters immediately before they are
cleared. (See above.)
<DT></span><span style="font-weight:bold">-N</span>, </span><span style="font-weight:bold">--new-chain</span> </span><span style="font-style:italic">chain</span><DD>
Create a new user-defined chain by the given name.  There must be no
target of that name already.
<DT></span><span style="font-weight:bold">-X</span>, </span><span style="font-weight:bold">--delete-chain</span> [</span><span style="font-style:italic">chain</span>]<DD>
Delete the optional user-defined chain specified.  There must be no references
to the chain.  If there are, you must delete or replace the referring rules
before the chain can be deleted.  The chain must be empty, i.e. not contain
any rules.  If no argument is given, it will attempt to delete every
non-builtin chain in the table.
<DT></span><span style="font-weight:bold">-P</span>, </span><span style="font-weight:bold">--policy</span> </span><span style="font-style:italic">chain target</span><DD>
Set the policy for the chain to the given target.  See the section </span><span style="font-weight:bold">TARGETS</span>
for the legal targets.  Only built-in (non-user-defined) chains can have
policies, and neither built-in nor user-defined chains can be policy
targets.
<DT></span><span style="font-weight:bold">-E</span>, </span><span style="font-weight:bold">--rename-chain</span> </span><span style="font-style:italic">old-chain new-chain</span><DD>
Rename the user specified chain to the user supplied name.  This is
cosmetic, and has no effect on the structure of the table.
<DT></span><span style="font-weight:bold">-h</span>

<DD>
Help.
Give a (currently very brief) description of the command syntax.
</DL>
</div>

<H3>PARAMETERS</H3>
<div>

The following parameters make up a rule specification (as used in the
add, delete, insert, replace and append commands).
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">-p</span>, </span><span style="font-weight:bold">--protocol</span> </span><span style="font-style:italic">protocol</span><DD>
The protocol of the rule or of the packet to check.
The specified protocol can be one of </span><span style="font-weight:bold">tcp</span>, </span><span style="font-weight:bold">udp</span>, </span><span style="font-weight:bold">udplite</span>,
</span><span style="font-weight:bold">icmp</span>, </span><span style="font-weight:bold">esp</span>, </span><span style="font-weight:bold">ah</span>, </span><span style="font-weight:bold">sctp</span> or </span><span style="font-weight:bold">all</span>,
or it can be a numeric value, representing one of these protocols or a
different one.  A protocol name from /etc/protocols is also allowed.
A &quot;!&quot; argument before the protocol inverts the
test.  The number zero is equivalent to </span><span style="font-weight:bold">all</span>.
Protocol </span><span style="font-weight:bold">all</span>
will match with all protocols and is taken as default when this
option is omitted.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">-s</span>, </span><span style="font-weight:bold">--source</span> </span><span style="font-style:italic">address</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Source specification. </span><span style="font-style:italic">Address</span>
can be either a network name, a hostname (please note that specifying
any name to be resolved with a remote query such as DNS is a really bad idea),
a network IP address (with </span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>), or a plain IP address.
The </span><span style="font-style:italic">mask</span>
can be either a network mask or a plain number,
specifying the number of 1's at the left side of the network mask.
Thus, a mask of </span><span style="font-style:italic">24</span> is equivalent to </span><span style="font-style:italic">255.255.255.0</span>.
A &quot;!&quot; argument before the address specification inverts the sense of
the address. The flag </span><span style="font-weight:bold">--src</span> is an alias for this option.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">-d</span>, </span><span style="font-weight:bold">--destination</span> </span><span style="font-style:italic">address</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Destination specification. 
See the description of the </span><span style="font-weight:bold">-s</span>
(source) flag for a detailed description of the syntax.  The flag
</span><span style="font-weight:bold">--dst</span> is an alias for this option.
<DT></span><span style="font-weight:bold">-j</span>, </span><span style="font-weight:bold">--jump</span> </span><span style="font-style:italic">target</span><DD>
This specifies the target of the rule; i.e., what to do if the packet
matches it.  The target can be a user-defined chain (other than the
one this rule is in), one of the special builtin targets which decide
the fate of the packet immediately, or an extension (see </span><span style="font-weight:bold">EXTENSIONS</span>
below).  If this
option is omitted in a rule (and </span><span style="font-weight:bold">-g</span>
is not used), then matching the rule will have no
effect on the packet's fate, but the counters on the rule will be
incremented.
<DT></span><span style="font-weight:bold">-g</span>, </span><span style="font-weight:bold">--goto</span> </span><span style="font-style:italic">chain</span><DD>
This specifies that the processing should continue in a user
specified chain. Unlike the --jump option return will not continue
processing in this chain but instead in the chain that called us via
--jump.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">-i</span>, </span><span style="font-weight:bold">--in-interface</span> </span><span style="font-style:italic">name</span><DD>
Name of an interface via which a packet was received (only for
packets entering the </span><span style="font-weight:bold">INPUT</span>, </span><span style="font-weight:bold">FORWARD</span> and </span><span style="font-weight:bold">PREROUTING</span>
chains).  When the &quot;!&quot; argument is used before the interface name, the
sense is inverted.  If the interface name ends in a &quot;+&quot;, then any
interface which begins with this name will match.  If this option is
omitted, any interface name will match.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">-o</span>, </span><span style="font-weight:bold">--out-interface</span> </span><span style="font-style:italic">name</span><DD>
Name of an interface via which a packet is going to be sent (for packets
entering the </span><span style="font-weight:bold">FORWARD</span>, </span><span style="font-weight:bold">OUTPUT</span> and </span><span style="font-weight:bold">POSTROUTING</span>
chains).  When the &quot;!&quot; argument is used before the interface name, the
sense is inverted.  If the interface name ends in a &quot;+&quot;, then any
interface which begins with this name will match.  If this option is
omitted, any interface name will match.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">-f</span>, </span><span style="font-weight:bold">--fragment</span><DD>
This means that the rule only refers to second and further fragments
of fragmented packets.  Since there is no way to tell the source or
destination ports of such a packet (or ICMP type), such a packet will
not match any rules which specify them.  When the &quot;!&quot; argument
precedes the &quot;-f&quot; flag, the rule will only match head fragments, or
unfragmented packets.
<DT></span><span style="font-weight:bold">-c</span>, </span><span style="font-weight:bold">--set-counters</span> </span><span style="font-style:italic">packets bytes</span><DD>
This enables the administrator to initialize the packet and byte
counters of a rule (during </span><span style="font-weight:bold">INSERT</span>, </span><span style="font-weight:bold">APPEND</span>, </span><span style="font-weight:bold">REPLACE</span>
operations).
</DL>
</span></div>

<H3>OTHER OPTIONS</H3>
<div>

The following additional options can be specified:
<br><br><DL>
<DT><span style="font-weight:bold">-v</span>, </span><span style="font-weight:bold">--verbose</span><DD>
Verbose output.  This option makes the list command show the interface
name, the rule options (if any), and the TOS masks.  The packet and
byte counters are also listed, with the suffix 'K', 'M' or 'G' for
1000, 1,000,000 and 1,000,000,000 multipliers respectively (but see
the </span><span style="font-weight:bold">-x</span> flag to change this).
For appending, insertion, deletion and replacement, this causes
detailed information on the rule or rules to be printed.
<DT></span><span style="font-weight:bold">-n</span>, </span><span style="font-weight:bold">--numeric</span><DD>
Numeric output.
IP addresses and port numbers will be printed in numeric format.
By default, the program will try to display them as host names,
network names, or services (whenever applicable).
<DT></span><span style="font-weight:bold">-x</span>, </span><span style="font-weight:bold">--exact</span><DD>
Expand numbers.
Display the exact value of the packet and byte counters,
instead of only the rounded number in K's (multiples of 1000)
M's (multiples of 1000K) or G's (multiples of 1000M).  This option is
only relevant for the </span><span style="font-weight:bold">-L</span> command.
<DT></span><span style="font-weight:bold">--line-numbers</span>

<DD>
When listing rules, add line numbers to the beginning of each rule,
corresponding to that rule's position in the chain.
<DT><span style="font-weight:bold">--modprobe=</span></span><span style="font-style:italic">command</span><DD>
When adding or inserting rules into a chain, use </span><span style="font-style:italic">command</span>
to load any necessary modules (targets, match extensions, etc).
</DL>
</span></div>

<H2>MATCH EXTENSIONS</H2>
<div>

iptables can use extended packet matching modules.  These are loaded
in two ways: implicitly, when <span style="font-weight:bold">-p</span> or </span><span style="font-weight:bold">--protocol</span>
is specified, or with the </span><span style="font-weight:bold">-m</span> or </span><span style="font-weight:bold">--match</span>
options, followed by the matching module name; after these, various
extra command line options become available, depending on the specific
module.  You can specify multiple extended match modules in one line,
and you can use the </span><span style="font-weight:bold">-h</span> or </span><span style="font-weight:bold">--help</span>
options after the module has been specified to receive help specific
to that module.
<P>
The following are included in the base package, and most of these can
be preceded by a &quot;</span><span style="font-weight:bold">!</span>&quot; to invert the sense of the match.

</span></div>

<H3>addrtype</H3>
<div>

This module matches packets based on their 
<span style="font-weight:bold">address type.</span>

Address types are used within the kernel networking stack and categorize
addresses into various groups.  The exact definition of that group depends on the specific layer three protocol.
<br><br><DL>
<DT>The following address types are possible:<DD>
<DT><span style="font-weight:bold">UNSPEC</span>

<DD>
an unspecified address (i.e. 0.0.0.0)
<DT><span style="font-weight:bold">UNICAST</span>

<DD>
an unicast address
<DT><span style="font-weight:bold">LOCAL</span>

<DD>
a local address
<DT><span style="font-weight:bold">BROADCAST</span>

<DD>
a broadcast address
<DT><span style="font-weight:bold">ANYCAST</span>

<DD>
an anycast packet
<DT><span style="font-weight:bold">MULTICAST</span>

<DD>
a multicast address
<DT><span style="font-weight:bold">BLACKHOLE</span>

<DD>
a blackhole address
<DT><span style="font-weight:bold">UNREACHABLE</span>

<DD>
an unreachable address
<DT><span style="font-weight:bold">PROHIBIT</span>

<DD>
a prohibited address
<DT><span style="font-weight:bold">THROW</span>

<DD>
FIXME
<DT><span style="font-weight:bold">NAT</span>

<DD>
FIXME
<DT><span style="font-weight:bold">XRESOLVE</span>

<DD>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--src-type</span> </span><span style="font-style:italic">type</span><DD>
Matches if the source address is of given type
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--dst-type</span> </span><span style="font-style:italic">type</span><DD>
Matches if the destination address is of given type
<DT></span><span style="font-weight:bold">--limit-iface-in</span>

<DD>
The address type checking can be limited to the interface the packet is coming
in. This option is only valid in the
<span style="font-weight:bold">PREROUTING</span>,

<span style="font-weight:bold">INPUT</span>

and
<span style="font-weight:bold">FORWARD</span>

chains. It cannot be specified with the
<span style="font-weight:bold">--limit-iface-out</span>

option.
<DT><span style="font-weight:bold">--limit-iface-out</span>

<DD>
The address type checiking can be limited to the interface the packet is going
out. This option is only valid in the
<span style="font-weight:bold">POSTROUTING</span>,

<span style="font-weight:bold">OUTPUT</span>

and
<span style="font-weight:bold">FORWARD</span>

chains. It cannot be specified with the
<span style="font-weight:bold">--limit-iface-in</span>

option.
</DL>
</div>

<H3>ah</H3>
<div>

This module matches the SPIs in Authentication header of IPsec packets.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--ahspi</span> </span><span style="font-style:italic">spi</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">spi</span>]<DD>
</DL>
</span></div>

<H3>comment</H3>
<div>

Allows you to add comments (up to 256 characters) to any rule.
<br><br><DL>
<DT><span style="font-weight:bold">--comment </span><span style="font-style:italic">comment</span>

<DD>
<DT>Example:<DD>
iptables -A INPUT -s 192.168.0.0/16 -m comment --comment &quot;A privatized IP block&quot;
</DL>
</div>

<H3>connbytes</H3>
<div>

Match by how many bytes or packets a connection (or one of the two
flows constituting the connection) has transferred so far, or by
average bytes per packet.
<P>
The counters are 64bit and are thus not expected to overflow ;)
<P>
The primary use is to detect long-lived downloads and mark them to be
scheduled using a lower priority band in traffic control.
<P>
The transferred bytes per connection can also be viewed through
/proc/net/ip_conntrack and accessed via ctnetlink
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--connbytes</span> </span><span style="font-style:italic">from</span>[</span><span style="font-weight:bold">:</span><span style="font-style:italic">to</span>]<DD>
match packets from a connection whose packets/bytes/average packet
size is more than FROM and less than TO bytes/packets. if TO is
omitted only FROM check is done. &quot;!&quot; is used to match packets not
falling in the range.
<DT></span><span style="font-weight:bold">--connbytes-dir</span> {<span style="font-weight:bold">original</span>|<span style="font-weight:bold">reply</span>|<span style="font-weight:bold">both</span>}<DD>
which packets to consider
<DT><span style="font-weight:bold">--connbytes-mode</span> {<span style="font-weight:bold">packets</span>|<span style="font-weight:bold">bytes</span>|<span style="font-weight:bold">avgpkt</span>}<DD>
whether to check the amount of packets, number of bytes transferred or
the average size (in bytes) of all packets received so far. Note that
when &quot;both&quot; is used together with &quot;avgpkt&quot;, and data is going (mainly)
only in one direction (for example HTTP), the average packet size will
be about half of the actual data packets.
<DT>Example:<DD>
iptables .. -m connbytes --connbytes 10000:100000 --connbytes-dir both --connbytes-mode bytes ...
</DL>
</div>

<H3>connlimit</H3>
<div>

Allows you to restrict the number of parallel connections to a server per
client IP address (or client address block).
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--connlimit-above</span> </span><span style="font-style:italic">n</span><DD>
Match if the number of existing connections is (not) above </span><span style="font-style:italic">n</span>.
<DT><span style="font-weight:bold">--connlimit-mask</span> <span style="font-style:italic">prefix_length</span><DD>
Group hosts using the prefix length. For IPv4, this must be a number between
(including) 0 and 32. For IPv6, between 0 and 128.
</DL>
<br><br>

Examples:
<br><br><DL>
<DT># allow 2 telnet connections per client host<DD>
iptables -A INPUT -p tcp --syn --dport 23 -m connlimit --connlimit-above 2 -j REJECT
<DT># you can also match the other way around:<DD>
iptables -A INPUT -p tcp --syn --dport 23 -m connlimit ! --connlimit-above 2 -j ACCEPT
<DT># limit the number of parallel HTTP requests to 16 per class C sized network (24 bit netmask)<DD>
iptables -p tcp --syn --dport 80 -m connlimit --connlimit-above 16
--connlimit-mask 24 -j REJECT
<DT># limit the number of parallel HTTP requests to 16 for the link local network (ipv6)<DD>
ip6tables -p tcp --syn --dport 80 -s fe80::/64 -m connlimit --connlimit-above
16 --connlimit-mask 64 -j REJECT
</DL>
</div>

<H3>connmark</H3>
<div>

This module matches the netfilter mark field associated with a connection
(which can be set using the <span style="font-weight:bold">CONNMARK</span> target below).
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--mark</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Matches packets in connections with the given mark value (if a mask is
specified, this is logically ANDed with the mark before the comparison).
</DL>
</div>

<H3>conntrack</H3>
<div>

This module, when combined with connection tracking, allows access to the
connection tracking state for this packet/connection.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctstate</span> <span style="font-style:italic">statelist</span><DD>
<span style="font-style:italic">statelist</span> is a comma separated list of the connection states to match.
Possible states are listed below.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctproto</span> <span style="font-style:italic">l4proto</span><DD>
Layer-4 protocol to match (by number or name)
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctorigsrc</span> <span style="font-style:italic">address</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctorigdst</span> <span style="font-style:italic">address</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctreplsrc</span> <span style="font-style:italic">address</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctrepldst</span> <span style="font-style:italic">address</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Match against original/reply source/destination address
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctorigsrcport</span> <span style="font-style:italic">port</span><DD>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctorigdstport</span> <span style="font-style:italic">port</span><DD>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctreplsrcport</span> <span style="font-style:italic">port</span><DD>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctrepldstport</span> <span style="font-style:italic">port</span><DD>
Match against original/reply source/destination port (TCP/UDP/etc.) or GRE key.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctstatus</span> <span style="font-style:italic">statelist</span><DD>
<span style="font-style:italic">statuslist</span> is a comma separated list of the connection statuses to match.
Possible statuses are listed below.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--ctexpire</span> <span style="font-style:italic">time</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">time</span>]<DD>
Match remaining lifetime in seconds against given value or range of values
(inclusive)
<DT><span style="font-weight:bold">--ctdir</span> {<span style="font-weight:bold">ORIGINAL</span>|<span style="font-weight:bold">REPLY</span>}<DD>
Match packets that are flowing in the specified direction. If this flag is not
specified at all, matches packets in both directions.
</DL>
<br><br>

States for <span style="font-weight:bold">--ctstate</span>:
<br><br><DL>
<DT><span style="font-weight:bold">INVALID</span><DD>
meaning that the packet is associated with no known connection
<DT><span style="font-weight:bold">NEW</span><DD>
meaning that the packet has started a new connection, or otherwise associated
with a connection which has not seen packets in both directions, and
<DT><span style="font-weight:bold">ESTABLISHED</span><DD>
meaning that the packet is associated with a connection which has seen packets
in both directions,
<DT><span style="font-weight:bold">RELATED</span><DD>
meaning that the packet is starting a new connection, but is associated with an
existing connection, such as an FTP data transfer, or an ICMP error.
<DT><span style="font-weight:bold">SNAT</span><DD>
A virtual state, matching if the original source address differs from the reply
destination.
<DT><span style="font-weight:bold">DNAT</span><DD>
A virtual state, matching if the original destination differs from the reply
source.
</DL>
<br><br>

Statuses for <span style="font-weight:bold">--ctstatus</span>:
<br><br><DL>
<DT><span style="font-weight:bold">NONE</span><DD>
None of the below.
<DT><span style="font-weight:bold">EXPECTED</span><DD>
This is an expected connection (i.e. a conntrack helper set it up)
<DT><span style="font-weight:bold">SEEN_REPLY</span><DD>
Conntrack has seen packets in both directions.
<DT><span style="font-weight:bold">ASSURED</span><DD>
Conntrack entry should never be early-expired.
<DT><span style="font-weight:bold">CONFIRMED</span><DD>
Connection is confirmed: originating packet has left box.
</DL>
</div>

<H3>dccp</H3>
<div>

<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--source-port</span>,</span><span style="font-weight:bold">--sport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--destination-port</span>,</span><span style="font-weight:bold">--dport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--dccp-types</span> <span style="font-style:italic">mask</span><DD>
Match when the DCCP packet type is one of 'mask'. 'mask' is a comma-separated
list of packet types.  Packet types are: 
</span><span style="font-weight:bold">REQUEST RESPONSE DATA ACK DATAACK CLOSEREQ CLOSE RESET SYNC SYNCACK INVALID</span>.

<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--dccp-option</span> <span style="font-style:italic">number</span><DD>
Match if DCP option set.
</DL>
</span></div>

<H3>dscp</H3>
<div>

This module matches the 6 bit DSCP field within the TOS field in the
IP header.  DSCP has superseded TOS within the IETF.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--dscp</span> </span><span style="font-style:italic">value</span><DD>
Match against a numeric (decimal or hex) value [0-63].
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--dscp-class</span> </span><span style="font-style:italic">class</span><DD>
Match the DiffServ class. This value may be any of the
BE, EF, AFxx or CSx classes.  It will then be converted
into its according numeric value.
</DL>
</span></div>

<H3>ecn</H3>
<div>

This allows you to match the ECN bits of the IPv4 and TCP header.  ECN is the Explicit Congestion Notification mechanism as specified in RFC3168
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--ecn-tcp-cwr</span><DD>
This matches if the TCP ECN CWR (Congestion Window Received) bit is set.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--ecn-tcp-ece</span><DD>
This matches if the TCP ECN ECE (ECN Echo) bit is set.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--ecn-ip-ect</span> </span><span style="font-style:italic">num</span><DD>
This matches a particular IPv4 ECT (ECN-Capable Transport). You have to specify
a number between `0' and `3'.
</DL>
</span></div>

<H3>esp</H3>
<div>

This module matches the SPIs in ESP header of IPsec packets.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--espspi</span> </span><span style="font-style:italic">spi</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">spi</span>]<DD>
</DL>
</span></div>

<H3>hashlimit</H3>
<div>

<span style="font-weight:bold">hashlimit</span> uses hash buckets to express a rate limiting match (like the
<span style="font-weight:bold">limit</span> match) for a group of connections using a <span style="font-weight:bold">single</span> iptables
rule. Grouping can be done per-hostgroup (source and/or destination address)
and/or per-port. It gives you the ability to express &quot;<span style="font-style:italic">N</span> packets per time
quantum per group&quot;:
<br><br><DL>
<DT>matching on source host<DD>
&quot;1000 packets per second for every host in 192.168.0.0/16&quot;
<DT>matching on source prot<DD>
&quot;100 packets per second for every service of 192.168.1.1&quot;
<DT>matching on subnet<DD>
&quot;10000 packets per minute for every /28 subnet in 10.0.0.0/8&quot;
</DL>
<br><br>

A hash limit option (<span style="font-weight:bold">--hashlimit-upto</span>, <span style="font-weight:bold">--hashlimit-above</span>) and
<span style="font-weight:bold">--hashlimit-name</span> are required.
<br><br><DL>
<DT><span style="font-weight:bold">--hashlimit-upto</span> <span style="font-style:italic">amount</span>[<span style="font-weight:bold">/second</span>|<span style="font-weight:bold">/minute</span>|<span style="font-weight:bold">/hour</span>|<span style="font-weight:bold">/day</span>]<DD>
Match if the rate is below or equal to <span style="font-style:italic">amount</span>/quantum. It is specified as
a number, with an optional time quantum suffix; the default is 3/hour.
<DT><span style="font-weight:bold">--hashlimit-above</span> <span style="font-style:italic">amount</span>[<span style="font-weight:bold">/second</span>|<span style="font-weight:bold">/minute</span>|<span style="font-weight:bold">/hour</span>|<span style="font-weight:bold">/day</span>]<DD>
Match if the rate is above <span style="font-style:italic">amount</span>/quantum.
<DT><span style="font-weight:bold">--hashlimit-burst</span> <span style="font-style:italic">amount</span><DD>
Maximum initial number of packets to match: this number gets recharged by one
every time the limit specified above is not reached, up to this number; the
default is 5.
<DT><span style="font-weight:bold">--hashlimit-mode</span> {<span style="font-weight:bold">srcip</span>|<span style="font-weight:bold">srcport</span>|<span style="font-weight:bold">dstip</span>|<span style="font-weight:bold">dstport</span>}<span style="font-weight:bold">,</span>...<DD>
A comma-separated list of objects to take into consideration. If no
--hashlimit-mode option is given, hashlimit acts like limit, but at the
expensive of doing the hash housekeeping.
<DT></span><span style="font-weight:bold">--hashlimit-srcmask</span> <span style="font-style:italic">prefix</span><DD>
When --hashlimit-mode srcip is used, all source addresses encountered will be
grouped according to the given prefix length and the so-created subnet will be
subject to hashlimit. <span style="font-style:italic">prefix</span> must be between (inclusive) 0 and 32. Note
that --hashlimit-srcmask 0 is basically doing the same thing as not specifying
srcip for --hashlimit-mode, but is technically more expensive.
<DT><span style="font-weight:bold">--hashlimit-dstmask</span> <span style="font-style:italic">prefix</span><DD>
Like --hashlimit-srcmask, but for destination addresses.
<DT><span style="font-weight:bold">--hashlimit-name</span> <span style="font-style:italic">foo</span><DD>
The name for the /proc/net/ipt_hashlimit/foo entry.
<DT><span style="font-weight:bold">--hashlimit-htable-size</span> <span style="font-style:italic">buckets</span><DD>
The number of buckets of the hash table
<DT><span style="font-weight:bold">--hashlimit-htable-max</span> <span style="font-style:italic">entries</span><DD>
Maximum entries in the hash.
<DT><span style="font-weight:bold">--hashlimit-htable-expire</span> <span style="font-style:italic">msec</span><DD>
After how many milliseconds do hash entries expire.
<DT><span style="font-weight:bold">--hashlimit-htable-gcinterval</span> <span style="font-style:italic">msec</span><DD>
How many milliseconds between garbage collection intervals.
</DL>
</div>

<H3>helper</H3>
<div>

This module matches packets related to a specific conntrack-helper.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--helper</span> </span><span style="font-style:italic">string</span><DD>
Matches packets related to the specified conntrack-helper.
<DL><DT><DD>
<br><br>

string can be &quot;ftp&quot; for packets related to a ftp-session on default port.
For other ports append -portnr to the value, ie. &quot;ftp-2121&quot;.
<br><br>

Same rules apply for other conntrack-helpers.
</DL>

</DL>
</span></div>

<H3>icmp</H3>
<div>

This extension can be used if `--protocol icmp' is specified.  It
provides the following option:
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--icmp-type</span> </span><span style="font-style:italic">typename</span><DD>
This allows specification of the ICMP type, which can be a numeric
ICMP type, or one of the ICMP type names shown by the command
</span><PRE>
 iptables -p icmp -h
</PRE>

</DL>
</div>

<H3>iprange</H3>
<div>

This matches on a given arbitrary range of IP addresses.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--src-range</span> <span style="font-style:italic">from</span>[<span style="font-weight:bold">-</span></span><span style="font-style:italic">to</span>]<DD>
Match source IP in the specified range.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--dst-range</span> <span style="font-style:italic">from</span>[<span style="font-weight:bold">-</span></span><span style="font-style:italic">to</span>]<DD>
Match destination IP in the specified range.
</DL>
</div>

<H3>length</H3>
<div>

This module matches the length of the layer-3 payload (e.g. layer-4 packet)
f a packet against a specific value
or range of values.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--length</span> </span><span style="font-style:italic">length</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">length</span>]<DD>
</DL>
</span></div>

<H3>limit</H3>
<div>

This module matches at a limited rate using a token bucket filter.
A rule using this extension will match until this limit is reached
(unless the `!' flag is used).  It can be used in combination with the
<span style="font-weight:bold">LOG</span>

target to give limited logging, for example.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--limit</span> </span><span style="font-style:italic">rate</span>[</span><span style="font-weight:bold">/second</span>|</span><span style="font-weight:bold">/minute</span>|</span><span style="font-weight:bold">/hour</span>|</span><span style="font-weight:bold">/day</span>]<DD>
Maximum average matching rate: specified as a number, with an optional
`/second', `/minute', `/hour', or `/day' suffix; the default is
3/hour.
<DT></span><span style="font-weight:bold">--limit-burst </span><span style="font-style:italic">number</span>

<DD>
Maximum initial number of packets to match: this number gets
recharged by one every time the limit specified above is not reached,
up to this number; the default is 5.
</DL>
</div>

<H3>mac</H3>
<div>

<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--mac-source</span> </span><span style="font-style:italic">address</span><DD>
Match source MAC address.  It must be of the form XX:XX:XX:XX:XX:XX.
Note that this only makes sense for packets coming from an Ethernet device
and entering the
</span><span style="font-weight:bold">PREROUTING</span>,

<span style="font-weight:bold">FORWARD</span>

or
<span style="font-weight:bold">INPUT</span>

chains.
</DL>
</div>

<H3>mark</H3>
<div>

This module matches the netfilter mark field associated with a packet
(which can be set using the
<span style="font-weight:bold">MARK</span>

target below).
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--mark</span> </span><span style="font-style:italic">value</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Matches packets with the given unsigned mark value (if a </span><span style="font-style:italic">mask</span> is
specified, this is logically ANDed with the </span><span style="font-style:italic">mask</span> before the
comparison).
</DL>
</span></div>

<H3>multiport</H3>
<div>

This module matches a set of source or destination ports.  Up to 15
ports can be specified.  A port range (port:port) counts as two
ports.  It can only be used in conjunction with
<span style="font-weight:bold">-p tcp</span>

or
<span style="font-weight:bold">-p udp</span>.

<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--source-ports</span>,</span><span style="font-weight:bold">--sport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span>|</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span></span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]...<DD>
Match if the source port is one of the given ports.  The flag
</span><span style="font-weight:bold">--sports</span>

is a convenient alias for this option. Multiple ports or port ranges are
separated using a comma, and a port range is specified using a colon.
<span style="font-weight:bold">53,1024:65535</span> would therefore match ports 53 and all from 1024 through
65535.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--destination-ports</span>,</span><span style="font-weight:bold">--dport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span>|</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span></span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]...<DD>
Match if the destination port is one of the given ports.  The flag
</span><span style="font-weight:bold">--dports</span>

is a convenient alias for this option.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--ports</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span>|</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span></span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]...<DD>
Match if either the source or destination ports are equal to one of
the given ports.
</DL>
</span></div>

<H3>owner</H3>
<div>

This module attempts to match various characteristics of the packet creator,
for locally generated packets. This match is only valid in the OUTPUT and
POSTROUTING chains. Forwarded packets do not have any socket associated with
them. Packets from kernel threads do have a socket, but usually no owner.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--uid-owner</span> </span><span style="font-style:italic">username</span><DD>
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--uid-owner</span> </span><span style="font-style:italic">userid</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">userid</span>]<DD>
Matches if the packet socket's file structure (if it has one) is owned by the
given user. You may also specify a numerical UID, or an UID range.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--gid-owner</span> </span><span style="font-style:italic">groupname</span><DD>
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--gid-owner</span> </span><span style="font-style:italic">groupid</span>[</span><span style="font-weight:bold">-</span><span style="font-style:italic">groupid</span>]<DD>
Matches if the packet socket's file structure is owned by the given group.
You may also specify a numerical GID, or a GID range.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--socket-exists</span><DD>
Matches if the packet is associated with a socket.
</DL>
</span></div>

<H3>physdev</H3>
<div>

This module matches on the bridge port input and output devices enslaved
to a bridge device. This module is a part of the infrastructure that enables
a transparent bridging IP firewall and is only useful for kernel versions
above version 2.5.44.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--physdev-in</span> </span><span style="font-style:italic">name</span><DD>
Name of a bridge port via which a packet is received (only for
packets entering the
</span><span style="font-weight:bold">INPUT</span>,

<span style="font-weight:bold">FORWARD</span>

and
<span style="font-weight:bold">PREROUTING</span>

chains). If the interface name ends in a &quot;+&quot;, then any
interface which begins with this name will match. If the packet didn't arrive
through a bridge device, this packet won't match this option, unless '!' is used.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--physdev-out</span> </span><span style="font-style:italic">name</span><DD>
Name of a bridge port via which a packet is going to be sent (for packets
entering the
</span><span style="font-weight:bold">FORWARD</span>,

<span style="font-weight:bold">OUTPUT</span>

and
<span style="font-weight:bold">POSTROUTING</span>

chains).  If the interface name ends in a &quot;+&quot;, then any
interface which begins with this name will match. Note that in the
<span style="font-weight:bold">nat</span> and <span style="font-weight:bold">mangle</span>

<span style="font-weight:bold">OUTPUT</span>

chains one cannot match on the bridge output port, however one can in the
<span style="font-weight:bold">filter OUTPUT</span>

chain. If the packet won't leave by a bridge device or it is yet unknown what
the output device will be, then the packet won't match this option, unless

<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--physdev-is-in</span><DD>
Matches if the packet has entered through a bridge interface.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--physdev-is-out</span><DD>
Matches if the packet will leave through a bridge interface.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--physdev-is-bridged</span><DD>
Matches if the packet is being bridged and therefore is not being routed.
This is only useful in the FORWARD and POSTROUTING chains.
</DL>
</span></div>

<H3>pkttype</H3>
<div>

This module matches the link-layer packet type.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--pkt-type</span> {</span><span style="font-weight:bold">unicast</span>|</span><span style="font-weight:bold">broadcast</span>|</span><span style="font-weight:bold">multicast</span>}<DD>
</DL>
</span></div>

<H3>policy</H3>
<div>

This modules matches the policy used by IPsec for handling a packet.
<br><br><DL>
<DT><span style="font-weight:bold">--dir</span> {</span><span style="font-weight:bold">in</span>|</span><span style="font-weight:bold">out</span>}<DD>
Used to select whether to match the policy used for decapsulation or the
policy that will be used for encapsulation.
</span><span style="font-weight:bold">in</span>

is valid in the
<span style="font-weight:bold">PREROUTING, INPUT and FORWARD</span>

chains,
<span style="font-weight:bold">out</span>

is valid in the
<span style="font-weight:bold">POSTROUTING, OUTPUT and FORWARD</span>

chains.
<DT><span style="font-weight:bold">--pol</span> {</span><span style="font-weight:bold">none</span>|</span><span style="font-weight:bold">ipsec</span>}<DD>
Matches if the packet is subject to IPsec processing.
<DT></span><span style="font-weight:bold">--strict</span>

<DD>
Selects whether to match the exact policy or match if any rule of
the policy matches the given policy.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--reqid</span> </span><span style="font-style:italic">id</span><DD>
Matches the reqid of the policy rule. The reqid can be specified with
</span><span style="font-weight:bold"><A HREF="man:setkey(8)">setkey</A>(8)</span>

using
<span style="font-weight:bold">unique:id</span>

as level.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--spi</span> </span><span style="font-style:italic">spi</span><DD>
Matches the SPI of the SA.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--proto</span> {</span><span style="font-weight:bold">ah</span>|</span><span style="font-weight:bold">esp</span>|</span><span style="font-weight:bold">ipcomp</span>}<DD>
Matches the encapsulation protocol.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--mode</span> {</span><span style="font-weight:bold">tunnel</span>|</span><span style="font-weight:bold">transport</span>}<DD>
Matches the encapsulation mode.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--tunnel-src</span> </span><span style="font-style:italic">addr</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Matches the source end-point address of a tunnel mode SA.
Only valid with </span><span style="font-weight:bold">--mode tunnel</span>.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--tunnel-dst</span> </span><span style="font-style:italic">addr</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Matches the destination end-point address of a tunnel mode SA.
Only valid with </span><span style="font-weight:bold">--mode tunnel</span>.
<DT></span><span style="font-weight:bold">--next</span>

<DD>
Start the next element in the policy specification. Can only be used with
<span style="font-weight:bold">--strict</span>.
</DL>
</span></div>

<H3>quota</H3>
<div>

Implements network quotas by decrementing a byte counter with each
packet.
<br><br><DL>
<DT><span style="font-weight:bold">--quota </span><span style="font-style:italic">bytes</span>

<DD>
The quota in bytes.
</DL>
<br><br>

</div>

<H3>realm</H3>
<div>

This matches the routing realm.  Routing realms are used in complex routing
setups involving dynamic routing protocols like BGP.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--realm</span> </span><span style="font-style:italic">value</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Matches a given realm number (and optionally mask). If not a number, value
can be a named realm from /etc/iproute2/rt_realms (mask can not be used in
that case).
</DL>
</span></div>

<H3>recent</H3>
<div>

Allows you to dynamically create a list of IP addresses and then match
against that list in a few different ways.
<P>
For example, you can create a `badguy' list out of people attempting
to connect to port 139 on your firewall and then DROP all future
packets from them without considering them.
<br><br><DL>
<DT><span style="font-weight:bold">--name </span><span style="font-style:italic">name</span>

<DD>
Specify the list to use for the commands. If no name is given then 'DEFAULT'
will be used.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--set</span><DD>
This will add the source address of the packet to the list. If the
source address is already in the list, this will update the existing
entry. This will always return success (or failure if `!' is passed
in).
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--rcheck</span><DD>
Check if the source address of the packet is currently in
the list.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--update</span><DD>
Like <span style="font-weight:bold">--rcheck</span>, except it will update the &quot;last seen&quot; timestamp if it
matches.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--remove</span><DD>
Check if the source address of the packet is currently in the list and
if so that address will be removed from the list and the rule will
return true. If the address is not found, false is returned.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--seconds </span><span style="font-style:italic">seconds</span><DD>
This option must be used in conjunction with one of <span style="font-weight:bold">--rcheck</span> or
<span style="font-weight:bold">--update</span>. When used, this will narrow the match to only happen
when the address is in the list and was seen within the last given
number of seconds.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--hitcount </span><span style="font-style:italic">hits</span><DD>
This option must be used in conjunction with one of <span style="font-weight:bold">--rcheck</span> or
<span style="font-weight:bold">--update</span>. When used, this will narrow the match to only happen
when the address is in the list and packets had been received greater
than or equal to the given value. This option may be used along with
<span style="font-weight:bold">--seconds</span> to create an even narrower match requiring a certain
number of hits within a specific time frame.
<DT><span style="font-weight:bold">--rttl</span><DD>
This option must be used in conjunction with one of <span style="font-weight:bold">--rcheck</span> or
<span style="font-weight:bold">--update</span>. When used, this will narrow the match to only happen
when the address is in the list and the TTL of the current packet
matches that of the packet which hit the <span style="font-weight:bold">--set</span> rule. This may be
useful if you have problems with people faking their source address in
order to DoS you via this module by disallowing others access to your
site by sending bogus packets to you.
</DL>
<br><br>

Examples:
<DL>
<DT><DD>
# iptables -A FORWARD -m recent --name badguy --rcheck --seconds 60 -j DROP
<P>
# iptables -A FORWARD -p tcp -i eth0 --dport 139 -m recent --name badguy --set -j DROP
</DL>
<br><br>

Official website (<A HREF="http://snowman.net/projects/ipt_recent/)">http://snowman.net/projects/ipt_recent/)</A> also has
some examples of usage.
<P>
/proc/net/ipt_recent/* are the current lists of addresses and information 
about each entry of each list.
<P>
Each file in /proc/net/ipt_recent/ can be read from to see the current list
or written two using the following commands to modify the list:
<br><br><DL>
<DT>echo xx.xx.xx.xx &gt; /proc/net/ipt_recent/DEFAULT<DD>
to Add to the DEFAULT list
<DT>echo -xx.xx.xx.xx &gt; /proc/net/ipt_recent/DEFAULT<DD>
to Remove from the DEFAULT list
<DT>echo clear &gt; /proc/net/ipt_recent/DEFAULT<DD>
to empty the DEFAULT list.
</DL>
<br><br>

The module itself accepts parameters, defaults shown:
<br><br><DL>
<DT><span style="font-weight:bold">ip_list_tot=</span><span style="font-style:italic">100</span>

<DD>
Number of addresses remembered per table
<DT><span style="font-weight:bold">ip_pkt_list_tot=</span><span style="font-style:italic">20</span>

<DD>
Number of packets per address remembered
<DT><span style="font-weight:bold">ip_list_hash_size=</span><span style="font-style:italic">0</span>

<DD>
Hash table size. 0 means to calculate it based on ip_list_tot, default: 512
<DT><span style="font-weight:bold">ip_list_perms=</span><span style="font-style:italic">0644</span>

<DD>
Permissions for /proc/net/ipt_recent/* files
<DT><span style="font-weight:bold">debug=</span><span style="font-style:italic">0</span>

<DD>
Set to 1 to get lots of debugging info
</DL>
</div>

<H3>sctp</H3>
<div>

<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--source-port</span>,</span><span style="font-weight:bold">--sport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--destination-port</span>,</span><span style="font-weight:bold">--dport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--chunk-types</span> {</span><span style="font-weight:bold">all</span>|</span><span style="font-weight:bold">any</span>|</span><span style="font-weight:bold">only</span>} </span><span style="font-style:italic">chunktype</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">flags</span>] [...]<DD>
The flag letter in upper case indicates that the flag is to match if set,
in the lower case indicates to match if unset.
<P>
Chunk types: DATA INIT INIT_ACK SACK HEARTBEAT HEARTBEAT_ACK ABORT SHUTDOWN SHUTDOWN_ACK ERROR COOKIE_ECHO COOKIE_ACK ECN_ECNE ECN_CWR SHUTDOWN_COMPLETE ASCONF ASCONF_ACK
<P>
chunk type            available flags      
<BR>

DATA                  U B E u b e         
<BR>

ABORT                 T t                 
<BR>

SHUTDOWN_COMPLETE     T t                 
<P>
(lowercase means flag should be &quot;off&quot;, uppercase means &quot;on&quot;)
</DL>
<br><br>

Examples:
<P>
iptables -A INPUT -p sctp --dport 80 -j DROP
<P>
iptables -A INPUT -p sctp --chunk-types any DATA,INIT -j DROP
<P>
iptables -A INPUT -p sctp --chunk-types any DATA:Be -j ACCEPT
</span></div>

<H3>set</H3>
<div>

This modules macthes IP sets which can be defined by <A HREF="man:ipset(8)">ipset</A>(8).
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--set</span> </span><span style="font-style:italic">setname</span> </span><span style="font-style:italic">flag</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">flag</span>]...<DD>
where flags are
</span><span style="font-weight:bold">src</span>

and/or
<span style="font-weight:bold">dst</span>

and there can be no more than six of them. Hence the command
<PRE>
 iptables -A FORWARD -m set --set test src,dst
</PRE>

will match packets, for which (depending on the type of the set) the source
address or port number of the packet can be found in the specified set. If 
there is a binding belonging to the mached set element or there is a default 
binding for the given set, then the rule will match the packet only if 
additionally (depending on the type of the set) the destination address or 
port number of the packet can be found in the set according to the binding.
</DL>
</div>

<H3>state</H3>
<div>

This module, when combined with connection tracking, allows access to
the connection tracking state for this packet.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--state</span> </span><span style="font-style:italic">state</span><DD>
Where state is a comma separated list of the connection states to
match.  Possible states are
</span><span style="font-weight:bold">INVALID</span>

meaning that the packet could not be identified for some reason which
includes running out of memory and ICMP errors which don't correspond to any
known connection,
<span style="font-weight:bold">ESTABLISHED</span>

meaning that the packet is associated with a connection which has seen
packets in both directions,
<span style="font-weight:bold">NEW</span>

meaning that the packet has started a new connection, or otherwise
associated with a connection which has not seen packets in both
directions, and
<span style="font-weight:bold">RELATED</span>

meaning that the packet is starting a new connection, but is
associated with an existing connection, such as an FTP data transfer,
or an ICMP error.
</DL>
</div>

<H3>statistic</H3>
<div>

This module matches packets based on some statistic condition.
It supports two distinct modes settable with the 
<span style="font-weight:bold">--mode</span>

option.
<br><br><DL>
<DT>Supported options:<DD>
<DT><span style="font-weight:bold">--mode </span><span style="font-style:italic">mode</span>

<DD>
Set the matching mode of the matching rule, supported modes are
<span style="font-weight:bold">random</span>

and
<span style="font-weight:bold">nth. </span>

<DT><span style="font-weight:bold">--probability </span><span style="font-style:italic">p</span>

<DD>
Set the probability from 0 to 1 for a packet to be randomly
matched. It works only with the
<span style="font-weight:bold">random</span>

mode.
<DT><span style="font-weight:bold">--every </span><span style="font-style:italic">n</span>

<DD>
Match one packet every nth packet. It works only with the
<span style="font-weight:bold">nth</span>

mode (see also the 
<span style="font-weight:bold">--packet</span>

option).
<DT><span style="font-weight:bold">--packet </span><span style="font-style:italic">p</span>

<DD>
Set the initial counter value (0 &lt;= p &lt;= n-1, default 0) for the
<span style="font-weight:bold">nth </span>

mode.
</DL>
</div>

<H3>string</H3>
<div>

This modules matches a given string by using some pattern matching strategy. It requires a linux kernel &gt;= 2.6.14.
<br><br><DL>
<DT><span style="font-weight:bold">--algo</span> {</span><span style="font-weight:bold">bm</span>|</span><span style="font-weight:bold">kmp</span>}<DD>
Select the pattern matching strategy. (bm = Boyer-Moore, kmp = Knuth-Pratt-Morris)
<DT></span><span style="font-weight:bold">--from </span><span style="font-style:italic">offset</span>

<DD>
Set the offset from which it starts looking for any matching. If not passed, default is 0.
<DT><span style="font-weight:bold">--to </span><span style="font-style:italic">offset</span>

<DD>
Set the offset from which it starts looking for any matching. If not passed, default is the packet size.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--string</span> </span><span style="font-style:italic">pattern</span><DD>
Matches the given pattern.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--hex-string</span> </span><span style="font-style:italic">pattern</span><DD>
Matches the given pattern in hex notation.
</DL>
</span></div>

<H3>tcp</H3>
<div>

These extensions can be used if `--protocol tcp' is specified. It
provides the following options:
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--source-port</span>,</span><span style="font-weight:bold">--sport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
Source port or port range specification. This can either be a service
name or a port number. An inclusive range can also be specified,
using the format </span><span style="font-style:italic">port</span></span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>.
If the first port is omitted, &quot;0&quot; is assumed; if the last is omitted,
&quot;65535&quot; is assumed.
If the second port greater then the first they will be swapped.
The flag
</span><span style="font-weight:bold">--sport</span>

is a convenient alias for this option.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--destination-port</span>,</span><span style="font-weight:bold">--dport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">port</span>]<DD>
Destination port or port range specification.  The flag
</span><span style="font-weight:bold">--dport</span>

is a convenient alias for this option.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--tcp-flags</span> </span><span style="font-style:italic">mask</span> </span><span style="font-style:italic">comp</span><DD>
Match when the TCP flags are as specified.  The first argument </span><span style="font-style:italic">mask</span> is the
flags which we should examine, written as a comma-separated list, and
the second argument </span><span style="font-style:italic">comp</span> is a comma-separated list of flags which must be
set.  Flags are:
</span><span style="font-weight:bold">SYN ACK FIN RST URG PSH ALL NONE</span>.

Hence the command
<PRE>
 iptables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST SYN
</PRE>

will only match packets with the SYN flag set, and the ACK, FIN and
RST flags unset.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--syn</span><DD>
Only match TCP packets with the SYN bit set and the ACK,RST and FIN bits
cleared.  Such packets are used to request TCP connection initiation;
for example, blocking such packets coming in an interface will prevent
incoming TCP connections, but outgoing TCP connections will be
unaffected.
It is equivalent to </span><span style="font-weight:bold">--tcp-flags SYN,RST,ACK,FIN SYN</span>.
If the &quot;!&quot; flag precedes the &quot;--syn&quot;, the sense of the
option is inverted.
<DT>[</span><span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--tcp-option</span> </span><span style="font-style:italic">number</span><DD>
Match if TCP option set.
</DL>
</span></div>

<H3>tcpmss</H3>
<div>

This matches the TCP MSS (maximum segment size) field of the TCP header.  You can only use this on TCP SYN or SYN/ACK packets, since the MSS is only negotiated during the TCP handshake at connection startup time.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--mss</span> </span><span style="font-style:italic">value</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">value</span>]<DD>
Match a given TCP MSS value or range.
</DL>
</span></div>

<H3>time</H3>
<div>

This matches if the packet arrival time/date is within a given range. All
options are optional, but are ANDed when specified.
<br><br><DL>
<DT><span style="font-weight:bold">--datestart</span> <span style="font-style:italic">YYYY</span>[<span style="font-weight:bold">-</span><span style="font-style:italic">MM</span>[<span style="font-weight:bold">-</span><span style="font-style:italic">DD</span>[<span style="font-weight:bold">T</span><span style="font-style:italic">hh</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">mm</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">ss</span>]]]]]<DD>
<DT><span style="font-weight:bold">--datestop</span> <span style="font-style:italic">YYYY</span>[<span style="font-weight:bold">-</span><span style="font-style:italic">MM</span>[<span style="font-weight:bold">-</span><span style="font-style:italic">DD</span>[<span style="font-weight:bold">T</span><span style="font-style:italic">hh</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">mm</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">ss</span>]]]]]<DD>
<DT><DD>
Only match during the given time, which must be in ISO 8601 &quot;T&quot; notation.
The possible time range is 1970-01-01T00:00:00 to 2038-01-19T04:17:07.
<DT><DD>
If --datestart or --datestop are not specified, it will default to 1970-01-01
and 2038-01-19, respectively.
<DT><span style="font-weight:bold">--timestart</span> <span style="font-style:italic">hh</span><span style="font-weight:bold">:</span><span style="font-style:italic">mm</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">ss</span>]<DD>
<DT><span style="font-weight:bold">--timestop</span> <span style="font-style:italic">hh</span><span style="font-weight:bold">:</span><span style="font-style:italic">mm</span>[<span style="font-weight:bold">:</span><span style="font-style:italic">ss</span>]<DD>
<DT><DD>
Only match during the given daytime. The possible time range is 00:00:00 to
23:59:59. Leading zeroes are allowed (e.g. &quot;06:03&quot;) and correctly interpreted
as base-10.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--monthdays</span> <span style="font-style:italic">day</span>[<span style="font-weight:bold">,</span><span style="font-style:italic">day</span>...]<DD>
<DT><DD>
Only match on the given days of the month. Possible values are <span style="font-weight:bold">1</span>
to <span style="font-weight:bold">31</span>. Note that specifying <span style="font-weight:bold">31</span> will of course not match
on months which do not have a 31st day; the same goes for 28- or 29-day
February.
<DT>[<span style="font-weight:bold">!</span>] <span style="font-weight:bold">--weekdays</span> <span style="font-style:italic">day</span>[<span style="font-weight:bold">,</span><span style="font-style:italic">day</span>...]<DD>
<DT><DD>
Only match on the given weekdays. Possible values are <span style="font-weight:bold">Mon</span>, <span style="font-weight:bold">Tue</span>,
<span style="font-weight:bold">Wed</span>, <span style="font-weight:bold">Thu</span>, <span style="font-weight:bold">Fri</span>, <span style="font-weight:bold">Sat</span>, <span style="font-weight:bold">Sun</span>, or values from <span style="font-weight:bold">1</span>
to <span style="font-weight:bold">7</span>, respectively. You may also use two-character variants (<span style="font-weight:bold">Mo</span>,
<span style="font-weight:bold">Tu</span>, etc.).
<DT><span style="font-weight:bold">--utc</span><DD>
<DT><DD>
Interpret the times given for <span style="font-weight:bold">--datestart</span>, <span style="font-weight:bold">--datestop</span>,
<span style="font-weight:bold">--timestart</span> and <span style="font-weight:bold">--timestop</span> to be UTC.
<DT><span style="font-weight:bold">--localtz</span><DD>
<DT><DD>
Interpret the times given for <span style="font-weight:bold">--datestart</span>, <span style="font-weight:bold">--datestop</span>,
<span style="font-weight:bold">--timestart</span> and <span style="font-weight:bold">--timestop</span> to be local kernel time. (Default)
</DL>
<br><br>

EXAMPLES. To match on weekends, use:
<DL>
<DT><DD>
-m time --weekdays Sa,Su
</DL>
<br><br>

Or, to match (once) on a national holiday block:
<DL>
<DT><DD>
-m time --datestart 2007-12-24 --datestop 2007-12-27
</DL>
<br><br>

Since the stop time is actually inclusive, you would need the following stop
time to not match the first second of the new day:
<DL>
<DT><DD>
-m time --datestart 2007-01-01T17:00 --datestop 2007-01-01T23:59:59
</DL>
<br><br>

During lunch hour:
<DL>
<DT><DD>
-m time --timestart 12:30 --timestop 13:30
</DL>
<br><br>

The fourth Friday in the month:
<DL>
<DT><DD>
-m time --weekdays Fr --monthdays 22,23,24,25,26,27,28
</DL>
<br><br>

(Note that this exploits a certain mathematical property. It is not possible to
say &quot;fourth Thursday OR fourth Friday&quot; in one rule. It is possible with
multiple rules, though.)
</div>

<H3>tos</H3>
<div>

This module matches the 8-bit Type of Service field in the IPv4 header (i.e.
including the &quot;Precedence&quot; bits) or the (also 8-bit) Priority field in the IPv6
header.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--tos</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Matches packets with the given TOS mark value. If a mask is specified, it is
logically ANDed with the TOS mark before the comparison.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--tos</span> <span style="font-style:italic">symbol</span><DD>
You can specify a symbolic name when using the tos match for IPv4. The list of
recognized TOS names can be obtained by calling iptables with <span style="font-weight:bold">-m tos -h</span>.
Note that this implies a mask of 0x3F, i.e. all but the ECN bits.
</DL>
</div>

<H3>ttl</H3>
<div>

This module matches the time to live field in the IP header.
<br><br><DL>
<DT><span style="font-weight:bold">--ttl-eq </span><span style="font-style:italic">ttl</span>

<DD>
Matches the given TTL value.
<DT><span style="font-weight:bold">--ttl-gt </span><span style="font-style:italic">ttl</span>

<DD>
Matches if TTL is greater than the given TTL value.
<DT><span style="font-weight:bold">--ttl-lt </span><span style="font-style:italic">ttl</span>

<DD>
Matches if TTL is less than the given TTL value.
</DL>
</div>

<H3>u32</H3>
<div>

U32 tests whether quantities of up to 4 bytes extracted from a packet have
specified values. The specification of what to extract is general enough to
find data at given offsets from tcp headers or payloads.
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--u32</span> </span><span style="font-style:italic">tests</span><DD>
The argument amounts to a program in a small language described below.
<DT><DD>
tests := location &quot;=&quot; value | tests &quot;&amp;&amp;&quot; location &quot;=&quot; value
<DT><DD>
value := range | value &quot;,&quot; range
<DT><DD>
range := number | number &quot;:&quot; number
</DL>
<br><br>

a single number, </span><span style="font-style:italic">n</span>, is interpreted the same as <span style="font-style:italic">n:n</span>. <span style="font-style:italic">n:m</span> is
interpreted as the range of numbers <span style="font-weight:bold">&gt;=n</span> and <span style="font-weight:bold">&lt;=m</span>.
<DL>
<DT><DD>
location := number | location operator number
<DT><DD>
operator := &quot;&amp;&quot; | &quot;&lt;&lt;&quot; | &quot;&gt;&gt;&quot; | &quot;@&quot;
</DL>
<br><br>

The operators <span style="font-weight:bold">&amp;</span>, <span style="font-weight:bold">&lt;&lt;</span>, <span style="font-weight:bold">&gt;&gt;</span> and <span style="font-weight:bold">&amp;&amp;</span> mean the same as in C.
The <span style="font-weight:bold">=</span> is really a set membership operator and the value syntax describes
a set. The <span style="font-weight:bold">@</span> operator is what allows moving to the next header and is
described further below.
<br><br>

There are currently some artificial implementation limits on the size of the
tests:
<DL>
<DT>    *<DD>
no more than 10 of &quot;<span style="font-weight:bold">=</span>&quot; (and 9 &quot;<span style="font-weight:bold">&amp;&amp;</span>&quot;s) in the u32 argument
<DT>    *<DD>
no more than 10 ranges (and 9 commas) per value
<DT>    *<DD>
no more than 10 numbers (and 9 operators) per location
</DL>
<br><br>

To describe the meaning of location, imagine the following machine that
interprets it. There are three registers:
<DL>
<DT><DD>
A is of type <span style="font-weight:bold">char *</span>, initially the address of the IP header
<DT><DD>
B and C are unsigned 32 bit integers, initially zero
</DL>
<br><br>

The instructions are:
<DL>
<DT><DD>
number B = number;
<DT><DD>
C = (*(A+B)&lt;&lt;24) + (*(A+B+1)&lt;&lt;16) + (*(A+B+2)&lt;&lt;8) + *(A+B+3)
<DT><DD>
&amp;number C = C &amp; number
<DT><DD>
&lt;&lt; number C = C &lt;&lt; number
<DT><DD>
&gt;&gt; number C = C &gt;&gt; number
<DT><DD>
@number A = A + C; then do the instruction number
</DL>
<br><br>

Any access of memory outside [skb-&gt;data,skb-&gt;end] causes the match to fail.
Otherwise the result of the computation is the final value of C.
<br><br>

Whitespace is allowed but not required in the tests. However, the characters
that do occur there are likely to require shell quoting, so it is a good idea
to enclose the arguments in quotes.
<br><br>

Example:
<DL>
<DT><DD>
match IP packets with total length &gt;= 256
<DT><DD>
The IP header contains a total length field in bytes 2-3.
<DT><DD>
--u32 &quot;<span style="font-weight:bold">0 &amp; 0xFFFF = 0x100:0xFFFF</span>&quot;
<DT><DD>
read bytes 0-3
<DT><DD>
AND that with 0xFFFF (giving bytes 2-3), and test whether that is in the range
[0x100:0xFFFF]
</DL>
<br><br>

Example: (more realistic, hence more complicated)
<DL>
<DT><DD>
match ICMP packets with icmp type 0
<DT><DD>
First test that it is an ICMP packet, true iff byte 9 (protocol) = 1
<DT><DD>
--u32 &quot;<span style="font-weight:bold">6 &amp; 0xFF = 1 &amp;&amp;</span> ...
<DT><DD>
read bytes 6-9, use <span style="font-weight:bold">&amp;</span> to throw away bytes 6-8 and compare the result to
1. Next test that it is not a fragment. (If so, it might be part of such a
packet but we cannot always tell.) N.B.: This test is generally needed if you
want to match anything beyond the IP header. The last 6 bits of byte 6 and all
of byte 7 are 0 iff this is a complete packet (not a fragment). Alternatively,
you can allow first fragments by only testing the last 5 bits of byte 6.
<DT><DD>
<BR>&nbsp;...&nbsp;<span style="font-weight:bold">4&nbsp;&amp;&nbsp;0x3FFF&nbsp;=&nbsp;0&nbsp;&amp;&amp;</span>&nbsp;...
<DT><DD>
Last test: the first byte past the IP header (the type) is 0. This is where we
have to use the @syntax. The length of the IP header (IHL) in 32 bit words is
stored in the right half of byte 0 of the IP header itself.
<DT><DD>
<BR>&nbsp;...&nbsp;<span style="font-weight:bold">0&nbsp;&gt;&gt;&nbsp;22&nbsp;&amp;&nbsp;0x3C&nbsp;@&nbsp;0&nbsp;&gt;&gt;&nbsp;24&nbsp;=&nbsp;0</span>&quot;
<DT><DD>
The first 0 means read bytes 0-3, <span style="font-weight:bold">&gt;&gt;22</span> means shift that 22 bits to the
right. Shifting 24 bits would give the first byte, so only 22 bits is four
times that plus a few more bits. <span style="font-weight:bold">&amp;3C</span> then eliminates the two extra bits
on the right and the first four bits of the first byte. For instance, if IHL=5,
then the IP header is 20 (4 x 5) bytes long. In this case, bytes 0-1 are (in
binary) xxxx0101 yyzzzzzz, <span style="font-weight:bold">&gt;&gt;22</span> gives the 10 bit value xxxx0101yy and
<span style="font-weight:bold">&amp;3C</span> gives 010100. <span style="font-weight:bold">@</span> means to use this number as a new offset into
the packet, and read four bytes starting from there. This is the first 4 bytes
of the ICMP payload, of which byte 0 is the ICMP type. Therefore, we simply
shift the value 24 to the right to throw out all but the first byte and compare
the result with 0.
</DL>
<br><br>

Example:
<DL>
<DT><DD>
TCP payload bytes 8-12 is any of 1, 2, 5 or 8
<DT><DD>
First we test that the packet is a tcp packet (similar to ICMP).
<DT><DD>
--u32 &quot;<span style="font-weight:bold">6 &amp; 0xFF = 6 &amp;&amp;</span> ...
<DT><DD>
Next, test that it is not a fragment (same as above).
<DT><DD>
<BR>&nbsp;...&nbsp;<span style="font-weight:bold">0&nbsp;&gt;&gt;&nbsp;22&nbsp;&amp;&nbsp;0x3C&nbsp;@&nbsp;12&nbsp;&gt;&gt;&nbsp;26&nbsp;&amp;&nbsp;0x3C&nbsp;@&nbsp;8&nbsp;=&nbsp;1,2,5,8</span>&quot;
<DT><DD>
<span style="font-weight:bold">0&gt;&gt;22&amp;3C</span> as above computes the number of bytes in the IP header. <span style="font-weight:bold">@</span>
makes this the new offset into the packet, which is the start of the TCP
header. The length of the TCP header (again in 32 bit words) is the left half
of byte 12 of the TCP header. The <span style="font-weight:bold">12&gt;&gt;26&amp;3C</span> computes this length in bytes
(similar to the IP header before). &quot;@&quot; makes this the new offset, which is the
start of the TCP payload. Finally, 8 reads bytes 8-12 of the payload and
<span style="font-weight:bold">=</span> checks whether the result is any of 1, 2, 5 or 8.
</DL>
</div>

<H3>udp</H3>
<div>

These extensions can be used if `--protocol udp' is specified.  It
provides the following options:
<br><br><DL>
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--source-port</span>,</span><span style="font-weight:bold">--sport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
Source port or port range specification.
See the description of the
</span><span style="font-weight:bold">--source-port</span>

option of the TCP extension for details.
<DT>[<span style="font-weight:bold">!</span>] </span><span style="font-weight:bold">--destination-port</span>,</span><span style="font-weight:bold">--dport</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>]<DD>
Destination port or port range specification.
See the description of the
</span><span style="font-weight:bold">--destination-port</span>

option of the TCP extension for details.
</DL>
</div>

<H3>unclean</H3>
<div>

This module takes no options, but attempts to match packets which seem
malformed or unusual.  This is regarded as experimental.
</div>

<H2>TARGET EXTENSIONS</H2>
<div>

iptables can use extended target modules: the following are included
in the standard distribution.

</div>

<H3>CLASSIFY</H3>
<div>

This module allows you to set the skb-&gt;priority value (and thus classify the packet into a specific CBQ class).
<br><br><DL>
<DT><span style="font-weight:bold">--set-class</span> </span><span style="font-style:italic">major</span></span><span style="font-weight:bold">:</span></span><span style="font-style:italic">minor</span><DD>
Set the major and minor class value.
</DL>
</span></div>

<H3>CLUSTERIP</H3>
<div>

This module allows you to configure a simple cluster of nodes that share
a certain IP and MAC address without an explicit load balancer in front of
them.  Connections are statically distributed between the nodes in this
cluster.
<br><br><DL>
<DT><span style="font-weight:bold">--new </span>

<DD>
Create a new ClusterIP.  You always have to set this on the first rule
for a given ClusterIP.
<DT><span style="font-weight:bold">--hashmode </span><span style="font-style:italic">mode</span>

<DD>
Specify the hashing mode.  Has to be one of
<span style="font-weight:bold">sourceip, sourceip-sourceport, sourceip-sourceport-destport</span>

<DT><span style="font-weight:bold">--clustermac </span><span style="font-style:italic">mac</span>

<DD>
Specify the ClusterIP MAC address.  Has to be a link-layer multicast address
<DT><span style="font-weight:bold">--total-nodes </span><span style="font-style:italic">num</span>

<DD>
Number of total nodes within this cluster.
<DT><span style="font-weight:bold">--local-node </span><span style="font-style:italic">num</span>

<DD>
Local node number within this cluster.
<DT><span style="font-weight:bold">--hash-init </span><span style="font-style:italic">rnd</span>

<DD>
Specify the random seed used for hash initialization.
</DL>
</div>

<H3>CONNMARK</H3>
<div>

This module sets the netfilter mark value associated with a connection.
<br><br><DL>
<DT><span style="font-weight:bold">--set-xmark</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Zero out the bits given by <span style="font-style:italic">mask</span> and XOR <span style="font-style:italic">value</span> into the ctmark.
<DT><span style="font-weight:bold">--save-mark</span> [<span style="font-weight:bold">--nfmask</span> <span style="font-style:italic">nfmask</span>] [<span style="font-weight:bold">--ctmask</span> <span style="font-style:italic">ctmask</span>]<DD>
Copy the packet mark (nfmark) to the connection mark (ctmark) using the given
masks. The new nfmark value is determined as follows:
<DT><DD>
ctmark = (ctmark &amp; ~ctmask) ^ (nfmark &amp; nfmask)
<DT><DD>
i.e. <span style="font-style:italic">ctmask</span> defines what bits to clear and <span style="font-style:italic">nfmask</span> what bits of the
nfmark to XOR into the ctmark. <span style="font-style:italic">ctmask</span> and <span style="font-style:italic">nfmask</span> default to
0xFFFFFFFF.
<DT><span style="font-weight:bold">--restore-mark</span> [<span style="font-weight:bold">--nfmask</span> <span style="font-style:italic">nfmask</span>] [<span style="font-weight:bold">--ctmask</span> <span style="font-style:italic">ctmask</span>]<DD>
Copy the connection mark (ctmark) to the packet mark (nfmark) using the given
masks. The new ctmark value is determined as follows:
<DT><DD>
nfmark = (nfmark &amp; ~<span style="font-style:italic">nfmask</span>) ^ (ctmark &amp; <span style="font-style:italic">ctmask</span>);
<DT><DD>
i.e. <span style="font-style:italic">nfmask</span> defines what bits to clear and <span style="font-style:italic">ctmask</span> what bits of the
ctmark to XOR into the nfmark. <span style="font-style:italic">ctmask</span> and <span style="font-style:italic">nfmask</span> default to
0xFFFFFFFF.
<DT><DD>
<span style="font-weight:bold">--restore-mark</span> is only valid in the <span style="font-weight:bold">mangle</span> table.
</DL>
<br><br>

The following mnemonics are available for <span style="font-weight:bold">--set-xmark</span>:
<br><br><DL>
<DT><span style="font-weight:bold">--and-mark</span> <span style="font-style:italic">bits</span><DD>
Binary AND the ctmark with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-xmark
0/</span><span style="font-style:italic">invbits</span>, where <span style="font-style:italic">invbits</span> is the binary negation of <span style="font-style:italic">bits</span>.)
<DT><span style="font-weight:bold">--or-mark</span> <span style="font-style:italic">bits</span><DD>
Binary OR the ctmark with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-xmark</span>
<span style="font-style:italic">bits</span><span style="font-weight:bold">/</span><span style="font-style:italic">bits</span>.)
<DT><span style="font-weight:bold">--xor-mark</span> <span style="font-style:italic">bits</span><DD>
Binary XOR the ctmark with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-xmark</span>
<span style="font-style:italic">bits</span><span style="font-weight:bold">/0</span>.)
<DT><span style="font-weight:bold">--set-mark</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Set the connection mark. If a mask is specified then only those bits set in the
mask are modified.
<DT><span style="font-weight:bold">--save-mark</span> [<span style="font-weight:bold">--mask</span> <span style="font-style:italic">mask</span>]<DD>
Copy the nfmark to the ctmark. If a mask is specified, only those bits are
copied.
<DT><span style="font-weight:bold">--restore-mark</span> [<span style="font-weight:bold">--mask</span> <span style="font-style:italic">mask</span>]<DD>
Copy the ctmark to the nfmark. If a mask is specified, only those bits are
copied. This is only valid in the <span style="font-weight:bold">mangle</span> table.
</DL>
</div>

<H3>CONNSECMARK</H3>
<div>

This module copies security markings from packets to connections
(if unlabeled), and from connections back to packets (also only
if unlabeled).  Typically used in conjunction with SECMARK, it is
only valid in the
<span style="font-weight:bold">mangle</span>

table.
<br><br><DL>
<DT><span style="font-weight:bold">--save</span>

<DD>
If the packet has a security marking, copy it to the connection
if the connection is not marked.
<DT><span style="font-weight:bold">--restore</span>

<DD>
If the packet does not have a security marking, and the connection
does, copy the security marking from the connection to the packet.
<P>
</DL>
</div>

<H3>DNAT</H3>
<div>

This target is only valid in the
<span style="font-weight:bold">nat</span>

table, in the
<span style="font-weight:bold">PREROUTING</span>

and
<span style="font-weight:bold">OUTPUT</span>

chains, and user-defined chains which are only called from those
chains.  It specifies that the destination address of the packet
should be modified (and all future packets in this connection will
also be mangled), and rules should cease being examined.  It takes one
type of option:
<br><br><DL>
<DT><span style="font-weight:bold">--to-destination</span> [</span><span style="font-style:italic">ipaddr</span>][</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">ipaddr</span>][</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">port</span>]]<DD>
which can specify a single new destination IP address, an inclusive
range of IP addresses, and optionally, a port range (which is only
valid if the rule also specifies
</span><span style="font-weight:bold">-p tcp</span>

or
<span style="font-weight:bold">-p udp</span>).

If no port range is specified, then the destination port will never be
modified. If no IP address is specified then only the destination port
will be modified.
<P>
In Kernels up to 2.6.10 you can add several --to-destination options.  For
those kernels, if you specify more than one destination address, either via an
address range or multiple --to-destination options, a simple round-robin (one
after another in cycle) load balancing takes place between these addresses.
Later Kernels (&gt;= 2.6.11-rc1) don't have the ability to NAT to multiple ranges
anymore.
<DT><span style="font-weight:bold">--random</span>

<DD>
If option
<span style="font-weight:bold">--random</span>

is used then port mapping will be randomized (kernel &gt;= 2.6.22).
<DL><DT><DD>
<br><br>

</DL>
</DL>
</div>

<H3>DSCP</H3>
<div>

This target allows to alter the value of the DSCP bits within the TOS
header of the IPv4 packet.  As this manipulates a packet, it can only
be used in the mangle table.
<br><br><DL>
<DT><span style="font-weight:bold">--set-dscp </span><span style="font-style:italic">value</span>

<DD>
Set the DSCP field to a numerical value (can be decimal or hex)
<DT><span style="font-weight:bold">--set-dscp-class </span><span style="font-style:italic">class</span>

<DD>
Set the DSCP field to a DiffServ class.
</DL>
</div>

<H3>ECN</H3>
<div>

This target allows to selectively work around known ECN blackholes.
It can only be used in the mangle table.
<br><br><DL>
<DT><span style="font-weight:bold">--ecn-tcp-remove</span>

<DD>
Remove all ECN bits from the TCP header.  Of course, it can only be used
in conjunction with
<span style="font-weight:bold">-p tcp</span>.

</DL>
</div>

<H3>LOG</H3>
<div>

Turn on kernel logging of matching packets.  When this option is set
for a rule, the Linux kernel will print some information on all
matching packets (like most IP header fields) via the kernel log
(where it can be read with
<span style="font-style:italic">dmesg</span>

or 
<span style="font-style:italic"><A HREF="man:syslogd(8)">syslogd</A></span>(8)).

This is a &quot;non-terminating target&quot;, i.e. rule traversal continues at
the next rule.  So if you want to LOG the packets you refuse, use two
separate rules with the same matching criteria, first using target LOG
then DROP (or REJECT).
<br><br><DL>
<DT><span style="font-weight:bold">--log-level </span><span style="font-style:italic">level</span>

<DD>
Level of logging (numeric or see <span style="font-style:italic"><A HREF="man:syslog.conf(5)">syslog.conf</A></span>(5)).
<DT></span><span style="font-weight:bold">--log-prefix </span><span style="font-style:italic">prefix</span>

<DD>
Prefix log messages with the specified prefix; up to 29 letters long,
and useful for distinguishing messages in the logs.
<DT><span style="font-weight:bold">--log-tcp-sequence</span>

<DD>
Log TCP sequence numbers. This is a security risk if the log is
readable by users.
<DT><span style="font-weight:bold">--log-tcp-options</span>

<DD>
Log options from the TCP packet header.
<DT><span style="font-weight:bold">--log-ip-options</span>

<DD>
Log options from the IP packet header.
<DT><span style="font-weight:bold">--log-uid</span>

<DD>
Log the userid of the process which generated the packet.
</DL>
</div>

<H3>MARK</H3>
<div>

This target is used to set the Netfilter mark value associated with the packet.
The target can only be used in the <span style="font-weight:bold">mangle</span> table. It can, for example, be
used in conjunction with routing based on fwmark (needs iproute2).
<br><br><DL>
<DT><span style="font-weight:bold">--set-xmark</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Zeroes out the bits given by <span style="font-style:italic">mask</span> and XORs <span style="font-style:italic">value</span> into the packet
mark (&quot;nfmark&quot;). If <span style="font-style:italic">mask</span> is omitted, 0xFFFFFFFF is assumed.
<DT><span style="font-weight:bold">--set-mark</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Zeroes out the bits given by <span style="font-style:italic">mask</span> and ORs <span style="font-style:italic">value</span> into the packet
mark. If <span style="font-style:italic">mask</span> is omitted, 0xFFFFFFFF is assumed.
</DL>
<br><br>

The following mnemonics are available:
<br><br><DL>
<DT><span style="font-weight:bold">--and-mark</span> <span style="font-style:italic">bits</span><DD>
Binary AND the nfmark with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-xmark
0/</span><span style="font-style:italic">invbits</span>, where <span style="font-style:italic">invbits</span> is the binary negation of <span style="font-style:italic">bits</span>.)
<DT><span style="font-weight:bold">--or-mark</span> <span style="font-style:italic">bits</span><DD>
Binary OR the nfmark with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-xmark</span>
<span style="font-style:italic">bits</span><span style="font-weight:bold">/</span><span style="font-style:italic">bits</span>.)
<DT><span style="font-weight:bold">--xor-mark</span> <span style="font-style:italic">bits</span><DD>
Binary XOR the nfmark with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-xmark</span>
<span style="font-style:italic">bits</span><span style="font-weight:bold">/0</span>.)
</DL>
</div>

<H3>MASQUERADE</H3>
<div>

This target is only valid in the
<span style="font-weight:bold">nat</span>

table, in the
<span style="font-weight:bold">POSTROUTING</span>

chain.  It should only be used with dynamically assigned IP (dialup)
connections: if you have a static IP address, you should use the SNAT
target.  Masquerading is equivalent to specifying a mapping to the IP
address of the interface the packet is going out, but also has the
effect that connections are
<span style="font-style:italic">forgotten</span>

when the interface goes down.  This is the correct behavior when the
next dialup is unlikely to have the same interface address (and hence
any established connections are lost anyway).  It takes one option:
<br><br><DL>
<DT><span style="font-weight:bold">--to-ports</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">port</span>]<DD>
This specifies a range of source ports to use, overriding the default
</span><span style="font-weight:bold">SNAT</span>

source port-selection heuristics (see above).  This is only valid
if the rule also specifies
<span style="font-weight:bold">-p tcp</span>

or
<span style="font-weight:bold">-p udp</span>.

<DT><span style="font-weight:bold">--random</span>

<DD>
Randomize source port mapping
If option
<span style="font-weight:bold">--random</span>

is used then port mapping will be randomized (kernel &gt;= 2.6.21).
<DL><DT><DD>
<br><br>

</DL>
</DL>
</div>

<H3>MIRROR</H3>
<div>

This is an experimental demonstration target which inverts the source
and destination fields in the IP header and retransmits the packet.
It is only valid in the
<span style="font-weight:bold">INPUT</span>,

<span style="font-weight:bold">FORWARD</span>

and
<span style="font-weight:bold">PREROUTING</span>

chains, and user-defined chains which are only called from those
chains.  Note that the outgoing packets are
<span style="font-weight:bold">NOT</span>

seen by any packet filtering chains, connection tracking or NAT, to
avoid loops and other problems.
</div>

<H3>NETMAP</H3>
<div>

This target allows you to statically map a whole network of addresses onto
another network of addresses.  It can only be used from rules in the
<span style="font-weight:bold">nat</span>

table.
<br><br><DL>
<DT><span style="font-weight:bold">--to</span> </span><span style="font-style:italic">address</span>[</span><span style="font-weight:bold">/</span></span><span style="font-style:italic">mask</span>]<DD>
Network address to map to.  The resulting address will be constructed in the
following way: All 'one' bits in the mask are filled in from the new `address'.
All bits that are zero in the mask are filled in from the original address.
</DL>
</span></div>

<H3>NFLOG</H3>
<div>

This target provides logging of matching packets. When this target is
set for a rule, the Linux kernel will pass the packet to the loaded
logging backend to log the packet. This is usually used in combination
with nfnetlink_log as logging backend, which will multicast the packet
through a
<span style="font-style:italic">netlink</span>

socket to the specified multicast group. One or more userspace processes
may subscribe to the group to receive the packets. Like LOG, this is a
non-terminating target, i.e. rule traversal continues at the next rule.
<br><br><DL>
<DT><span style="font-weight:bold">--nflog-group </span><span style="font-style:italic">nlgroup</span>

<DD>
The netlink group (1 - 2^32-1) to which packets are (only applicable for
nfnetlink_log). The default value is 0.
<DT><span style="font-weight:bold">--nflog-prefix </span><span style="font-style:italic">prefix</span>

<DD>
A prefix string to include in the log message, up to 64 characters
long, useful for distinguishing messages in the logs.
<DT><span style="font-weight:bold">--nflog-range </span><span style="font-style:italic">size</span>

<DD>
The number of bytes to be copied to userspace (only applicable for
nfnetlink_log). nfnetlink_log instances may specify their own
range, this option overrides it.
<DT><span style="font-weight:bold">--nflog-threshold </span><span style="font-style:italic">size</span>

<DD>
Number of packets to queue inside the kernel before sending them
to userspace (only applicable for nfnetlink_log). Higher values
result in less overhead per packet, but increase delay until the
packets reach userspace. The default value is 1.
<span style="font-weight:bold">.SS</span>NFQUEUE

This target is an extension of the QUEUE target. As opposed to QUEUE, it allows
you to put a packet into any specific queue, identified by its 16-bit queue
number.  
<DT><span style="font-weight:bold">--queue-num</span> </span><span style="font-style:italic">value</span><DD>
This specifies the QUEUE number to use. Valid queue numbers are 0 to 65535. The default value is 0.
<DT>It can only be used with Kernel versions 2.6.14 or later, since it requires<DD>
the
</span><span style="font-weight:bold">nfnetlink_queue</span>

kernel support.
</DL>
</div>

<H3>NOTRACK</H3>
<div>

This target disables connection tracking for all packets matching that rule.
<br><br><DL>
<DT>It can only be used in the<DD>
<span style="font-weight:bold">raw</span>

table.
</DL>
</div>

<H3>RATEEST</H3>
<div>

The RATEEST target collects statistics, performs rate estimation calculation
and saves the results for later evaluation using the <span style="font-weight:bold">rateest</span> match.
<br><br><DL>
<DT></span><span style="font-weight:bold">--rateest-name</span> </span><span style="font-style:italic">name</span><DD>
Count matched packets into the pool referred to by </span><span style="font-style:italic">name</span>, which is freely
choosable.
<DT></span><span style="font-weight:bold">--rateest-interval</span> </span><span style="font-style:italic">amount</span>{</span><span style="font-weight:bold">s</span>|</span><span style="font-weight:bold">ms</span>|</span><span style="font-weight:bold">us</span>}<DD>
Rate measurement interval, in seconds, milliseconds or microseconds.
<DT></span><span style="font-weight:bold">--rateest-ewmalog</span> </span><span style="font-style:italic">value</span><DD>
</DL>
</span></div>

<H3>REDIRECT</H3>
<div>

This target is only valid in the
<span style="font-weight:bold">nat</span>

table, in the
<span style="font-weight:bold">PREROUTING</span>

and
<span style="font-weight:bold">OUTPUT</span>

chains, and user-defined chains which are only called from those
chains.  It redirects the packet to the machine itself by changing the
destination IP to the primary address of the incoming interface
(locally-generated packets are mapped to the 127.0.0.1 address).
<br><br><DL>
<DT><span style="font-weight:bold">--to-ports</span> </span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">port</span>]<DD>
This specifies a destination port or range of ports to use: without
this, the destination port is never altered.  This is only valid
if the rule also specifies
</span><span style="font-weight:bold">-p tcp</span>

or
<span style="font-weight:bold">-p udp</span>.

<DT><span style="font-weight:bold">--random</span>

<DD>
If option
<span style="font-weight:bold">--random</span>

is used then port mapping will be randomized (kernel &gt;= 2.6.22).
<DL><DT><DD>
<br><br>

</DL>
</DL>
</div>

<H3>REJECT</H3>
<div>

This is used to send back an error packet in response to the matched
packet: otherwise it is equivalent to
<span style="font-weight:bold">DROP</span>

so it is a terminating TARGET, ending rule traversal.
This target is only valid in the
<span style="font-weight:bold">INPUT</span>,

<span style="font-weight:bold">FORWARD</span>

and
<span style="font-weight:bold">OUTPUT</span>

chains, and user-defined chains which are only called from those
chains.  The following option controls the nature of the error packet
returned:
<br><br><DL>
<DT><span style="font-weight:bold">--reject-with </span><span style="font-style:italic">type</span>

<DD>
The type given can be
<PRE>
<span style="font-weight:bold"> icmp-net-unreachable</span>
<span style="font-weight:bold"> icmp-host-unreachable</span>
<span style="font-weight:bold"> icmp-port-unreachable</span>
<span style="font-weight:bold"> icmp-proto-unreachable</span>
<span style="font-weight:bold"> icmp-net-prohibited</span>
<span style="font-weight:bold"> icmp-host-prohibited or</span>
<span style="font-weight:bold"> icmp-admin-prohibited (*)</span>
</PRE>

which return the appropriate ICMP error message (<span style="font-weight:bold">port-unreachable</span> is
the default).  The option
</span><span style="font-weight:bold">tcp-reset</span>

can be used on rules which only match the TCP protocol: this causes a
TCP RST packet to be sent back.  This is mainly useful for blocking 
<span style="font-style:italic">ident</span>

(113/tcp) probes which frequently occur when sending mail to broken mail
hosts (which won't accept your mail otherwise).
<DT>(*) Using icmp-admin-prohibited with kernels that do not support it will result in a plain DROP instead of REJECT<DD>
</DL>
</div>

<H3>SAME</H3>
<div>

Similar to SNAT/DNAT depending on chain: it takes a range of addresses
(`--to 1.2.3.4-1.2.3.7') and gives a client the same
source-/destination-address for each connection.
<br><br><DL>
<DT><span style="font-weight:bold">--to</span> </span><span style="font-style:italic">ipaddr</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">ipaddr</span>]<DD>
Addresses to map source to. May be specified more than once for
multiple ranges.
<DT></span><span style="font-weight:bold">--nodst</span>

<DD>
Don't use the destination-ip in the calculations when selecting the
new source-ip
<DT><span style="font-weight:bold">--random</span>

<DD>
Port mapping will be forcibly randomized to avoid attacks based on 
port prediction (kernel &gt;= 2.6.21).
</DL>
</div>

<H3>SECMARK</H3>
<div>

This is used to set the security mark value associated with the
packet for use by security subsystems such as SELinux.  It is only
valid in the
<span style="font-weight:bold">mangle</span>

table.
<br><br><DL>
<DT><span style="font-weight:bold">--selctx </span><span style="font-style:italic">security_context</span>

<DD>
</DL>
</div>

<H3>SET</H3>
<div>

This modules adds and/or deletes entries from IP sets which can be defined 
by <A HREF="man:ipset(8)">ipset</A>(8).
<br><br><DL>
<DT><span style="font-weight:bold">--add-set</span> </span><span style="font-style:italic">setname</span> </span><span style="font-style:italic">flag</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">flag</span>...]<DD>
add the address(es)/port(s) of the packet to the sets
<DT></span><span style="font-weight:bold">--del-set</span> </span><span style="font-style:italic">setname</span> </span><span style="font-style:italic">flag</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">flag</span>...]<DD>
delete the address(es)/port(s) of the packet from the sets,
where flags are
</span><span style="font-weight:bold">src</span>

and/or
<span style="font-weight:bold">dst</span>

and there can be no more than six of them.
<DT>The bindings to follow must previously be defined in order to use <DD>
multilevel adding/deleting by the SET target.
</DL>
</div>

<H3>SNAT</H3>
<div>

This target is only valid in the
<span style="font-weight:bold">nat</span>

table, in the
<span style="font-weight:bold">POSTROUTING</span>

chain.  It specifies that the source address of the packet should be
modified (and all future packets in this connection will also be
mangled), and rules should cease being examined.  It takes one type
of option:
<br><br><DL>
<DT><span style="font-weight:bold">--to-source</span> </span><span style="font-style:italic">ipaddr</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">ipaddr</span>][</span><span style="font-weight:bold">:</span></span><span style="font-style:italic">port</span>[</span><span style="font-weight:bold">-</span></span><span style="font-style:italic">port</span>]]<DD>
which can specify a single new source IP address, an inclusive range
of IP addresses, and optionally, a port range (which is only valid if
the rule also specifies
</span><span style="font-weight:bold">-p tcp</span>

or
<span style="font-weight:bold">-p udp</span>).

If no port range is specified, then source ports below 512 will be
mapped to other ports below 512: those between 512 and 1023 inclusive
will be mapped to ports below 1024, and other ports will be mapped to
1024 or above. Where possible, no port alteration will
<P>
In Kernels up to 2.6.10, you can add several --to-source options.  For those
kernels, if you specify more than one source address, either via an address
range or multiple --to-source options, a simple round-robin (one after another
in cycle) takes place between these addresses.
Later Kernels (&gt;= 2.6.11-rc1) don't have the ability to NAT to multiple ranges
anymore.
<DT><span style="font-weight:bold">--random</span>

<DD>
If option
<span style="font-weight:bold">--random</span>

is used then port mapping will be randomized (kernel &gt;= 2.6.21).
<DL><DT><DD>
<br><br>

</DL>
</DL>
</div>

<H3>TCPMSS</H3>
<div>

This target allows to alter the MSS value of TCP SYN packets, to control
the maximum size for that connection (usually limiting it to your
outgoing interface's MTU minus 40 for IPv4 or 60 for IPv6, respectively).
Of course, it can only be used
in conjunction with
<span style="font-weight:bold">-p tcp</span>.

It is only valid in the
<span style="font-weight:bold">mangle</span>

table.
<BR>

This target is used to overcome criminally braindead ISPs or servers
which block &quot;ICMP Fragmentation Needed&quot; or &quot;ICMPv6 Packet Too Big&quot;
packets.  The symptoms of this
problem are that everything works fine from your Linux
firewall/router, but machines behind it can never exchange large
packets:

<DL><DT><DD>
<br><br><DL>
<DT>1)<DD>
Web browsers connect, then hang with no data received.
<DT>2)<DD>
Small mail works fine, but large emails hang.
<DT>3)<DD>
ssh works fine, but scp hangs after initial handshaking.
</DL></DL>


Workaround: activate this option and add a rule to your firewall
configuration like:
<PRE>
 iptables -t mangle -A FORWARD -p tcp --tcp-flags SYN,RST SYN \
             -j TCPMSS --clamp-mss-to-pmtu
</PRE>

<br><br><DL>
<DT><span style="font-weight:bold">--set-mss </span><span style="font-style:italic">value</span>

<DD>
Explicitly set MSS option to specified value.
<DT><span style="font-weight:bold">--clamp-mss-to-pmtu</span>

<DD>
Automatically clamp MSS value to (path_MTU - 40 for IPv4; -60 for IPv6).
<DT>These options are mutually exclusive.<DD>
</DL>
</div>

<H3>TCPOPTSTRIP</H3>
<div>

This target will strip TCP options off a TCP packet. (It will actually replace
them by NO-OPs.) As such, you will need to add the <span style="font-weight:bold">-p tcp</span> parameters.
<br><br><DL>
<DT><span style="font-weight:bold">--strip-options</span> </span><span style="font-style:italic">option</span>[</span><span style="font-weight:bold">,</span></span><span style="font-style:italic">option</span>...]<DD>
Strip the given option(s). The options may be specified by TCP option number or
by symbolic name. The list of recognized options can be obtained by calling
iptables with </span><span style="font-weight:bold">-j TCPOPTSTRIP -h</span>.
</DL>
</div>

<H3>TOS</H3>
<div>

This module sets the Type of Service field in the IPv4 header (including the

shares the same bits as DSCP and ECN. The TOS target is only valid in the
<span style="font-weight:bold">mangle</span> table.
<br><br><DL>
<DT><span style="font-weight:bold">--set-tos</span> <span style="font-style:italic">value</span>[<span style="font-weight:bold">/</span><span style="font-style:italic">mask</span>]<DD>
Zeroes out the bits given by <span style="font-style:italic">mask</span> and XORs <span style="font-style:italic">value</span> into the
TOS/Priority field. If <span style="font-style:italic">mask</span> is omitted, 0xFF is assumed.
<DT><span style="font-weight:bold">--set-tos</span> <span style="font-style:italic">symbol</span><DD>
You can specify a symbolic name when using the TOS target for IPv4. It implies
a mask of 0xFF. The list of recognized TOS names can be obtained by calling
iptables with <span style="font-weight:bold">-j TOS -h</span>.
</DL>
<br><br>

The following mnemonics are available:
<br><br><DL>
<DT><span style="font-weight:bold">--and-tos</span> <span style="font-style:italic">bits</span><DD>
Binary AND the TOS value with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-tos
0/</span><span style="font-style:italic">invbits</span>, where <span style="font-style:italic">invbits</span> is the binary negation of <span style="font-style:italic">bits</span>.)
<DT><span style="font-weight:bold">--or-tos</span> <span style="font-style:italic">bits</span><DD>
Binary OR the TOS value with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-tos</span>
<span style="font-style:italic">bits</span><span style="font-weight:bold">/</span><span style="font-style:italic">bits</span>.)
<DT><span style="font-weight:bold">--xor-tos</span> <span style="font-style:italic">bits</span><DD>
Binary XOR the TOS value with <span style="font-style:italic">bits</span>. (Mnemonic for <span style="font-weight:bold">--set-tos</span>
<span style="font-style:italic">bits</span><span style="font-weight:bold">/0</span>.)
</DL>
</div>

<H3>TRACE</H3>
<div>

This target marks packes so that the kernel will log every rule which match 
the packets as those traverse the tables, chains, rules. (The ipt_LOG or
ip6t_LOG module 
is required for the logging.) The packets are logged with the string prefix: 
&quot;TRACE: tablename:chainname:type:rulenum &quot; where type can be &quot;rule&quot; for 
plain rule, &quot;return&quot; for implicit rule at the end of a user defined chain 
and &quot;policy&quot; for the policy of the built in chains. 
<BR>

It can only be used in the
<span style="font-weight:bold">raw</span>

table.
</div>

<H3>TTL</H3>
<div>

This is used to modify the IPv4 TTL header field.  The TTL field determines
how many hops (routers) a packet can traverse until it's time to live is
exceeded.
<br><br><DL>
<DT>Setting or incrementing the TTL field can potentially be very dangerous,<DD>
so it should be avoided at any cost.  
<DT><span style="font-weight:bold">Don't ever set or increment the value on packets that leave your local network!</span>

<DD>
<span style="font-weight:bold">mangle</span>

table.
<DT><span style="font-weight:bold">--ttl-set </span><span style="font-style:italic">value</span>

<DD>
Set the TTL value to `value'.
<DT><span style="font-weight:bold">--ttl-dec </span><span style="font-style:italic">value</span>

<DD>
Decrement the TTL value `value' times.
<DT><span style="font-weight:bold">--ttl-inc </span><span style="font-style:italic">value</span>

<DD>
Increment the TTL value `value' times.
</DL>
</div>

<H3>ULOG</H3>
<div>

This target provides userspace logging of matching packets.  When this
target is set for a rule, the Linux kernel will multicast this packet
through a
<span style="font-style:italic">netlink</span>

socket. One or more userspace processes may then subscribe to various 
multicast groups and receive the packets.
Like LOG, this is a &quot;non-terminating target&quot;, i.e. rule traversal
continues at the next rule.
<br><br><DL>
<DT><span style="font-weight:bold">--ulog-nlgroup </span><span style="font-style:italic">nlgroup</span>

<DD>
This specifies the netlink group (1-32) to which the packet is sent.
Default value is 1.
<DT><span style="font-weight:bold">--ulog-prefix </span><span style="font-style:italic">prefix</span>

<DD>
Prefix log messages with the specified prefix; up to 32 characters
long, and useful for distinguishing messages in the logs.
<DT><span style="font-weight:bold">--ulog-cprange </span><span style="font-style:italic">size</span>

<DD>
Number of bytes to be copied to userspace.  A value of 0 always copies
the entire packet, regardless of its size.  Default is 0.
<DT><span style="font-weight:bold">--ulog-qthreshold </span><span style="font-style:italic">size</span>

<DD>
Number of packet to queue inside kernel.  Setting this value to, e.g. 10
accumulates ten packets inside the kernel and transmits them as one
netlink multipart message to userspace.  Default is 1 (for backwards
compatibility).
<BR>

</DL>
</div>

<H2>DIAGNOSTICS</H2>
<div>

Various error messages are printed to standard error.  The exit code
is 0 for correct functioning.  Errors which appear to be caused by
invalid or abused command line parameters cause an exit code of 2, and
other errors cause an exit code of 1.
</div>

<H2>BUGS</H2>
<div>

Bugs?  What's this? ;-)
Well, you might want to have a look at <A HREF="http://bugzilla.netfilter.org/">http://bugzilla.netfilter.org/</A>
</div>

<H2>COMPATIBILITY WITH IPCHAINS</H2>
<div>

This <span style="font-weight:bold">iptables</span>
is very similar to ipchains by Rusty Russell.  The main difference is
that the chains </span><span style="font-weight:bold">INPUT</span> and </span><span style="font-weight:bold">OUTPUT</span>
are only traversed for packets coming into the local host and
originating from the local host respectively.  Hence every packet only
passes through one of the three chains (except loopback traffic, which
involves both INPUT and OUTPUT chains); previously a forwarded packet
would pass through all three.
<br><br>

The other main difference is that </span><span style="font-weight:bold">-i</span> refers to the input interface;
</span><span style="font-weight:bold">-o</span> refers to the output interface, and both are available for packets
entering the </span><span style="font-weight:bold">FORWARD</span> chain.
<br><br>

The various forms of NAT have been separated out; </span><span style="font-weight:bold">iptables</span>
is a pure packet filter when using the default `filter' table, with
optional extension modules.  This should simplify much of the previous
confusion over the combination of IP masquerading and packet filtering
seen previously.  So the following options are handled differently:
</span><PRE>
 -j MASQ
 -M -S
 -M -L
</PRE>

There are several other changes in iptables.
</div>

<H2>SEE ALSO</H2>
<div>

<span style="font-weight:bold"><A HREF="man:iptables-save(8)">iptables-save</A></span>(8),

<span style="font-weight:bold"><A HREF="man:iptables-restore(8)">iptables-restore</A></span>(8),

<span style="font-weight:bold"><A HREF="man:ip6tables(8)">ip6tables</A></span>(8),

<span style="font-weight:bold"><A HREF="man:ip6tables-save(8)">ip6tables-save</A></span>(8),

<span style="font-weight:bold"><A HREF="man:ip6tables-restore(8)">ip6tables-restore</A></span>(8),

<span style="font-weight:bold"><A HREF="man:libipq(3)">libipq</A></span>(3).

<br><br>

The packet-filtering-HOWTO details iptables usage for
packet filtering, the NAT-HOWTO details NAT,
the netfilter-extensions-HOWTO details the extensions that are
not in the standard distribution,
and the netfilter-hacking-HOWTO details the netfilter internals.
<BR>

See
<span style="font-weight:bold"><A HREF="http://www.netfilter.org/">http://www.netfilter.org/</A></span>.

</div>

<H2>AUTHORS</H2>
<div>

Rusty Russell originally wrote iptables, in early consultation with Michael
Neuling.
<br><br>

Marc Boucher made Rusty abandon ipnatctl by lobbying for a generic packet
selection framework in iptables, then wrote the mangle table, the owner match,
the mark stuff, and ran around doing cool stuff everywhere.
<br><br>

James Morris wrote the TOS target, and tos match.
<br><br>

Jozsef Kadlecsik wrote the REJECT target.
<br><br>

Harald Welte wrote the ULOG and NFQUEUE target, the new libiptc, as well as the TTL, DSCP, ECN matches and targets.
<br><br>

The Netfilter Core Team is: Marc Boucher, Martin Josefsson, Yasuyuki Kozakai,
Jozsef Kadlecsik, Patrick McHardy, James Morris, Pablo Neira Ayuso,
Harald Welte and Rusty Russell.
<br><br>

Man page originally written by Herve Eychenne &lt;<A HREF="mailto:rv@wallfire.org">rv@wallfire.org</A>&gt;.





<div style="margin-left: 2cm">
</div>
<div class="bannerBottom" style="background-image: url(file:/opt/kde3/share/doc/HTML//en/common/bottom-middle.png); background-repeat: x-repeat; width: 100%; height: 100px; bottom:0pt;">
<div class="bannerBottomLeft">
<img src="file:/opt/kde3/share/doc/HTML//en/common/bottom-left.png" style="margin: 0pt;" alt="Bottom left of the banner">
</div>
<div class="bannerBottomRight">
<img src="file:/opt/kde3/share/doc/HTML//en/common/bottom-right.png" style="margin: 0pt" alt="Bottom right of the banner">
</div>
</div>
</BODY>
</HTML>
